{"abi":[{"type":"function","name":"computeMessageHash","inputs":[{"name":"to","type":"address","internalType":"address"},{"name":"value","type":"uint256","internalType":"uint256"},{"name":"data","type":"bytes","internalType":"bytes"},{"name":"operation","type":"uint8","internalType":"uint8"},{"name":"nextPKH","type":"bytes32","internalType":"bytes32"}],"outputs":[{"name":"m","type":"uint256","internalType":"uint256"}],"stateMutability":"view"},{"type":"function","name":"execWithLamport","inputs":[{"name":"to","type":"address","internalType":"address"},{"name":"value","type":"uint256","internalType":"uint256"},{"name":"data","type":"bytes","internalType":"bytes"},{"name":"operation","type":"uint8","internalType":"uint8"},{"name":"sig","type":"bytes[256]","internalType":"bytes[256]"},{"name":"currentPub","type":"bytes32[2][256]","internalType":"bytes32[2][256]"},{"name":"nextPKH","type":"bytes32","internalType":"bytes32"}],"outputs":[{"name":"success","type":"bool","internalType":"bool"}],"stateMutability":"nonpayable"},{"type":"function","name":"init","inputs":[{"name":"initialPkh","type":"bytes32","internalType":"bytes32"}],"outputs":[],"stateMutability":"nonpayable"},{"type":"function","name":"initialized","inputs":[],"outputs":[{"name":"","type":"bool","internalType":"bool"}],"stateMutability":"view"},{"type":"function","name":"lamportNonce","inputs":[],"outputs":[{"name":"","type":"uint256","internalType":"uint256"}],"stateMutability":"view"},{"type":"function","name":"pkh","inputs":[],"outputs":[{"name":"","type":"bytes32","internalType":"bytes32"}],"stateMutability":"view"},{"type":"function","name":"safe","inputs":[],"outputs":[{"name":"","type":"address","internalType":"address"}],"stateMutability":"view"},{"type":"event","name":"LamportExecuted","inputs":[{"name":"safeTxHash","type":"bytes32","indexed":true,"internalType":"bytes32"},{"name":"nextPkh","type":"bytes32","indexed":true,"internalType":"bytes32"},{"name":"nonce","type":"uint256","indexed":false,"internalType":"uint256"}],"anonymous":false},{"type":"event","name":"LamportInitialized","inputs":[{"name":"initialPkh","type":"bytes32","indexed":true,"internalType":"bytes32"}],"anonymous":false},{"type":"event","name":"LamportKeyRotated","inputs":[{"name":"oldPkh","type":"bytes32","indexed":true,"internalType":"bytes32"},{"name":"newPkh","type":"bytes32","indexed":true,"internalType":"bytes32"}],"anonymous":false},{"type":"error","name":"AlreadyInitialized","inputs":[]},{"type":"error","name":"InvalidLamportSignature","inputs":[]},{"type":"error","name":"InvalidPublicKey","inputs":[]},{"type":"error","name":"NotInitialized","inputs":[]},{"type":"error","name":"OnlySafe","inputs":[]}],"bytecode":{"object":"0x","sourceMap":"","linkReferences":{}},"deployedBytecode":{"object":"0x","sourceMap":"","linkReferences":{}},"methodIdentifiers":{"computeMessageHash(address,uint256,bytes,uint8,bytes32)":"5f384225","execWithLamport(address,uint256,bytes,uint8,bytes[256],bytes32[2][256],bytes32)":"cd0fb1b3","init(bytes32)":"3b663195","initialized()":"158ef93e","lamportNonce()":"6a685e3a","pkh()":"3cbf3893","safe()":"186f0354"},"rawMetadata":"{\"compiler\":{\"version\":\"0.8.31+commit.fd3a2265\"},\"language\":\"Solidity\",\"output\":{\"abi\":[{\"inputs\":[],\"name\":\"AlreadyInitialized\",\"type\":\"error\"},{\"inputs\":[],\"name\":\"InvalidLamportSignature\",\"type\":\"error\"},{\"inputs\":[],\"name\":\"InvalidPublicKey\",\"type\":\"error\"},{\"inputs\":[],\"name\":\"NotInitialized\",\"type\":\"error\"},{\"inputs\":[],\"name\":\"OnlySafe\",\"type\":\"error\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":true,\"internalType\":\"bytes32\",\"name\":\"safeTxHash\",\"type\":\"bytes32\"},{\"indexed\":true,\"internalType\":\"bytes32\",\"name\":\"nextPkh\",\"type\":\"bytes32\"},{\"indexed\":false,\"internalType\":\"uint256\",\"name\":\"nonce\",\"type\":\"uint256\"}],\"name\":\"LamportExecuted\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":true,\"internalType\":\"bytes32\",\"name\":\"initialPkh\",\"type\":\"bytes32\"}],\"name\":\"LamportInitialized\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":true,\"internalType\":\"bytes32\",\"name\":\"oldPkh\",\"type\":\"bytes32\"},{\"indexed\":true,\"internalType\":\"bytes32\",\"name\":\"newPkh\",\"type\":\"bytes32\"}],\"name\":\"LamportKeyRotated\",\"type\":\"event\"},{\"inputs\":[{\"internalType\":\"address\",\"name\":\"to\",\"type\":\"address\"},{\"internalType\":\"uint256\",\"name\":\"value\",\"type\":\"uint256\"},{\"internalType\":\"bytes\",\"name\":\"data\",\"type\":\"bytes\"},{\"internalType\":\"uint8\",\"name\":\"operation\",\"type\":\"uint8\"},{\"internalType\":\"bytes32\",\"name\":\"nextPKH\",\"type\":\"bytes32\"}],\"name\":\"computeMessageHash\",\"outputs\":[{\"internalType\":\"uint256\",\"name\":\"m\",\"type\":\"uint256\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"address\",\"name\":\"to\",\"type\":\"address\"},{\"internalType\":\"uint256\",\"name\":\"value\",\"type\":\"uint256\"},{\"internalType\":\"bytes\",\"name\":\"data\",\"type\":\"bytes\"},{\"internalType\":\"uint8\",\"name\":\"operation\",\"type\":\"uint8\"},{\"internalType\":\"bytes[256]\",\"name\":\"sig\",\"type\":\"bytes[256]\"},{\"internalType\":\"bytes32[2][256]\",\"name\":\"currentPub\",\"type\":\"bytes32[2][256]\"},{\"internalType\":\"bytes32\",\"name\":\"nextPKH\",\"type\":\"bytes32\"}],\"name\":\"execWithLamport\",\"outputs\":[{\"internalType\":\"bool\",\"name\":\"success\",\"type\":\"bool\"}],\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"bytes32\",\"name\":\"initialPkh\",\"type\":\"bytes32\"}],\"name\":\"init\",\"outputs\":[],\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"initialized\",\"outputs\":[{\"internalType\":\"bool\",\"name\":\"\",\"type\":\"bool\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"lamportNonce\",\"outputs\":[{\"internalType\":\"uint256\",\"name\":\"\",\"type\":\"uint256\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"pkh\",\"outputs\":[{\"internalType\":\"bytes32\",\"name\":\"\",\"type\":\"bytes32\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"safe\",\"outputs\":[{\"internalType\":\"address\",\"name\":\"\",\"type\":\"address\"}],\"stateMutability\":\"view\",\"type\":\"function\"}],\"devdoc\":{\"author\":\"Lux Network Team\",\"kind\":\"dev\",\"methods\":{\"computeMessageHash(address,uint256,bytes,uint8,bytes32)\":{\"params\":{\"data\":\"Call data\",\"nextPKH\":\"Next public key hash\",\"operation\":\"Operation type (0=Call, 1=DelegateCall)\",\"to\":\"Destination address\",\"value\":\"ETH value\"},\"returns\":{\"m\":\"The message hash to sign (256 bits)\"}},\"execWithLamport(address,uint256,bytes,uint8,bytes[256],bytes32[2][256],bytes32)\":{\"params\":{\"currentPub\":\"Current public key (bytes32[2][256])\",\"data\":\"Call data\",\"nextPKH\":\"Hash of next public key (for rotation)\",\"operation\":\"0 = Call, 1 = DelegateCall\",\"sig\":\"Lamport signature (bytes[256])\",\"to\":\"Destination address\",\"value\":\"ETH value in wei\"},\"returns\":{\"success\":\"True if execution succeeded\"}},\"init(bytes32)\":{\"params\":{\"initialPkh\":\"Hash of initial Lamport public key\"}}},\"title\":\"ILamportModule\",\"version\":1},\"userdoc\":{\"errors\":{\"AlreadyInitialized()\":[{\"notice\":\"Error when module is already initialized\"}],\"InvalidLamportSignature()\":[{\"notice\":\"Error when Lamport signature is invalid\"}],\"InvalidPublicKey()\":[{\"notice\":\"Error when public key doesn't match stored hash\"}],\"NotInitialized()\":[{\"notice\":\"Error when module is not initialized\"}],\"OnlySafe()\":[{\"notice\":\"Error when caller is not the Safe\"}]},\"events\":{\"LamportExecuted(bytes32,bytes32,uint256)\":{\"notice\":\"Emitted when a transaction is executed with Lamport signature\"},\"LamportInitialized(bytes32)\":{\"notice\":\"Emitted when module is initialized\"},\"LamportKeyRotated(bytes32,bytes32)\":{\"notice\":\"Emitted when Lamport key is rotated\"}},\"kind\":\"user\",\"methods\":{\"computeMessageHash(address,uint256,bytes,uint8,bytes32)\":{\"notice\":\"Compute the message hash that should be signed\"},\"execWithLamport(address,uint256,bytes,uint8,bytes[256],bytes32[2][256],bytes32)\":{\"notice\":\"Execute Safe transaction with Lamport signature\"},\"init(bytes32)\":{\"notice\":\"Initialize with first Lamport public key hash\"},\"initialized()\":{\"notice\":\"Check if module is initialized\"},\"lamportNonce()\":{\"notice\":\"Get current Lamport nonce\"},\"pkh()\":{\"notice\":\"Get current public key hash\"},\"safe()\":{\"notice\":\"Get the Safe address this module is attached to\"}},\"notice\":\"Interface for Lamport signature Safe modules\",\"version\":1}},\"settings\":{\"compilationTarget\":{\"ILamportModule.sol\":\"ILamportModule\"},\"evmVersion\":\"prague\",\"libraries\":{},\"metadata\":{\"bytecodeHash\":\"ipfs\"},\"optimizer\":{\"enabled\":true,\"runs\":200},\"remappings\":[\":forge-std/=lib/forge-std/src/\"]},\"sources\":{\"ILamportModule.sol\":{\"keccak256\":\"0xc868a9587dac1ce2b9402db6b17aa24fdbfe0f52dd6a568360106c301ca84940\",\"license\":\"BSD-3-Clause\",\"urls\":[\"bzz-raw://f05ecacf6b79dce6bf313ad9c5fb618f6a54723472071ef9b2c70b56f546677a\",\"dweb:/ipfs/QmYs7CXpW9JWYjNzxQcfXrY2rewfNj6dFk6hQyRbTV857c\"]}},\"version\":1}","metadata":{"compiler":{"version":"0.8.31+commit.fd3a2265"},"language":"Solidity","output":{"abi":[{"inputs":[],"type":"error","name":"AlreadyInitialized"},{"inputs":[],"type":"error","name":"InvalidLamportSignature"},{"inputs":[],"type":"error","name":"InvalidPublicKey"},{"inputs":[],"type":"error","name":"NotInitialized"},{"inputs":[],"type":"error","name":"OnlySafe"},{"inputs":[{"internalType":"bytes32","name":"safeTxHash","type":"bytes32","indexed":true},{"internalType":"bytes32","name":"nextPkh","type":"bytes32","indexed":true},{"internalType":"uint256","name":"nonce","type":"uint256","indexed":false}],"type":"event","name":"LamportExecuted","anonymous":false},{"inputs":[{"internalType":"bytes32","name":"initialPkh","type":"bytes32","indexed":true}],"type":"event","name":"LamportInitialized","anonymous":false},{"inputs":[{"internalType":"bytes32","name":"oldPkh","type":"bytes32","indexed":true},{"internalType":"bytes32","name":"newPkh","type":"bytes32","indexed":true}],"type":"event","name":"LamportKeyRotated","anonymous":false},{"inputs":[{"internalType":"address","name":"to","type":"address"},{"internalType":"uint256","name":"value","type":"uint256"},{"internalType":"bytes","name":"data","type":"bytes"},{"internalType":"uint8","name":"operation","type":"uint8"},{"internalType":"bytes32","name":"nextPKH","type":"bytes32"}],"stateMutability":"view","type":"function","name":"computeMessageHash","outputs":[{"internalType":"uint256","name":"m","type":"uint256"}]},{"inputs":[{"internalType":"address","name":"to","type":"address"},{"internalType":"uint256","name":"value","type":"uint256"},{"internalType":"bytes","name":"data","type":"bytes"},{"internalType":"uint8","name":"operation","type":"uint8"},{"internalType":"bytes[256]","name":"sig","type":"bytes[256]"},{"internalType":"bytes32[2][256]","name":"currentPub","type":"bytes32[2][256]"},{"internalType":"bytes32","name":"nextPKH","type":"bytes32"}],"stateMutability":"nonpayable","type":"function","name":"execWithLamport","outputs":[{"internalType":"bool","name":"success","type":"bool"}]},{"inputs":[{"internalType":"bytes32","name":"initialPkh","type":"bytes32"}],"stateMutability":"nonpayable","type":"function","name":"init"},{"inputs":[],"stateMutability":"view","type":"function","name":"initialized","outputs":[{"internalType":"bool","name":"","type":"bool"}]},{"inputs":[],"stateMutability":"view","type":"function","name":"lamportNonce","outputs":[{"internalType":"uint256","name":"","type":"uint256"}]},{"inputs":[],"stateMutability":"view","type":"function","name":"pkh","outputs":[{"internalType":"bytes32","name":"","type":"bytes32"}]},{"inputs":[],"stateMutability":"view","type":"function","name":"safe","outputs":[{"internalType":"address","name":"","type":"address"}]}],"devdoc":{"kind":"dev","methods":{"computeMessageHash(address,uint256,bytes,uint8,bytes32)":{"params":{"data":"Call data","nextPKH":"Next public key hash","operation":"Operation type (0=Call, 1=DelegateCall)","to":"Destination address","value":"ETH value"},"returns":{"m":"The message hash to sign (256 bits)"}},"execWithLamport(address,uint256,bytes,uint8,bytes[256],bytes32[2][256],bytes32)":{"params":{"currentPub":"Current public key (bytes32[2][256])","data":"Call data","nextPKH":"Hash of next public key (for rotation)","operation":"0 = Call, 1 = DelegateCall","sig":"Lamport signature (bytes[256])","to":"Destination address","value":"ETH value in wei"},"returns":{"success":"True if execution succeeded"}},"init(bytes32)":{"params":{"initialPkh":"Hash of initial Lamport public key"}}},"version":1},"userdoc":{"kind":"user","methods":{"computeMessageHash(address,uint256,bytes,uint8,bytes32)":{"notice":"Compute the message hash that should be signed"},"execWithLamport(address,uint256,bytes,uint8,bytes[256],bytes32[2][256],bytes32)":{"notice":"Execute Safe transaction with Lamport signature"},"init(bytes32)":{"notice":"Initialize with first Lamport public key hash"},"initialized()":{"notice":"Check if module is initialized"},"lamportNonce()":{"notice":"Get current Lamport nonce"},"pkh()":{"notice":"Get current public key hash"},"safe()":{"notice":"Get the Safe address this module is attached to"}},"version":1}},"settings":{"remappings":["forge-std/=lib/forge-std/src/"],"optimizer":{"enabled":true,"runs":200},"metadata":{"bytecodeHash":"ipfs"},"compilationTarget":{"ILamportModule.sol":"ILamportModule"},"evmVersion":"prague","libraries":{}},"sources":{"ILamportModule.sol":{"keccak256":"0xc868a9587dac1ce2b9402db6b17aa24fdbfe0f52dd6a568360106c301ca84940","urls":["bzz-raw://f05ecacf6b79dce6bf313ad9c5fb618f6a54723472071ef9b2c70b56f546677a","dweb:/ipfs/QmYs7CXpW9JWYjNzxQcfXrY2rewfNj6dFk6hQyRbTV857c"],"license":"BSD-3-Clause"}},"version":1},"id":0}