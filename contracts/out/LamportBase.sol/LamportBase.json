{"abi":[{"type":"function","name":"getPKH","inputs":[],"outputs":[{"name":"","type":"bytes32","internalType":"bytes32"}],"stateMutability":"view"},{"type":"function","name":"init","inputs":[{"name":"firstPKH","type":"bytes32","internalType":"bytes32"}],"outputs":[],"stateMutability":"nonpayable"},{"type":"function","name":"initialized","inputs":[],"outputs":[{"name":"","type":"bool","internalType":"bool"}],"stateMutability":"view"},{"type":"function","name":"pkh","inputs":[],"outputs":[{"name":"","type":"bytes32","internalType":"bytes32"}],"stateMutability":"view"},{"type":"function","name":"verify_u256","inputs":[{"name":"bits","type":"uint256","internalType":"uint256"},{"name":"sig","type":"bytes[256]","internalType":"bytes[256]"},{"name":"pub","type":"bytes32[2][256]","internalType":"bytes32[2][256]"}],"outputs":[{"name":"valid","type":"bool","internalType":"bool"}],"stateMutability":"pure"},{"type":"event","name":"LamportInitialized","inputs":[{"name":"initialPkh","type":"bytes32","indexed":true,"internalType":"bytes32"}],"anonymous":false},{"type":"event","name":"LamportKeyRotated","inputs":[{"name":"oldPkh","type":"bytes32","indexed":true,"internalType":"bytes32"},{"name":"newPkh","type":"bytes32","indexed":true,"internalType":"bytes32"}],"anonymous":false},{"type":"error","name":"AlreadyInitialized","inputs":[]},{"type":"error","name":"InvalidLamportSignature","inputs":[]},{"type":"error","name":"InvalidPublicKeyHash","inputs":[]},{"type":"error","name":"NotInitialized","inputs":[]}],"bytecode":{"object":"0x","sourceMap":"","linkReferences":{}},"deployedBytecode":{"object":"0x","sourceMap":"","linkReferences":{}},"methodIdentifiers":{"getPKH()":"6ed10fbb","init(bytes32)":"3b663195","initialized()":"158ef93e","pkh()":"3cbf3893","verify_u256(uint256,bytes[256],bytes32[2][256])":"af82f3e7"},"rawMetadata":"{\"compiler\":{\"version\":\"0.8.31+commit.fd3a2265\"},\"language\":\"Solidity\",\"output\":{\"abi\":[{\"inputs\":[],\"name\":\"AlreadyInitialized\",\"type\":\"error\"},{\"inputs\":[],\"name\":\"InvalidLamportSignature\",\"type\":\"error\"},{\"inputs\":[],\"name\":\"InvalidPublicKeyHash\",\"type\":\"error\"},{\"inputs\":[],\"name\":\"NotInitialized\",\"type\":\"error\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":true,\"internalType\":\"bytes32\",\"name\":\"initialPkh\",\"type\":\"bytes32\"}],\"name\":\"LamportInitialized\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":true,\"internalType\":\"bytes32\",\"name\":\"oldPkh\",\"type\":\"bytes32\"},{\"indexed\":true,\"internalType\":\"bytes32\",\"name\":\"newPkh\",\"type\":\"bytes32\"}],\"name\":\"LamportKeyRotated\",\"type\":\"event\"},{\"inputs\":[],\"name\":\"getPKH\",\"outputs\":[{\"internalType\":\"bytes32\",\"name\":\"\",\"type\":\"bytes32\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"bytes32\",\"name\":\"firstPKH\",\"type\":\"bytes32\"}],\"name\":\"init\",\"outputs\":[],\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"initialized\",\"outputs\":[{\"internalType\":\"bool\",\"name\":\"\",\"type\":\"bool\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"pkh\",\"outputs\":[{\"internalType\":\"bytes32\",\"name\":\"\",\"type\":\"bytes32\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"uint256\",\"name\":\"bits\",\"type\":\"uint256\"},{\"internalType\":\"bytes[256]\",\"name\":\"sig\",\"type\":\"bytes[256]\"},{\"internalType\":\"bytes32[2][256]\",\"name\":\"pub\",\"type\":\"bytes32[2][256]\"}],\"name\":\"verify_u256\",\"outputs\":[{\"internalType\":\"bool\",\"name\":\"valid\",\"type\":\"bool\"}],\"stateMutability\":\"pure\",\"type\":\"function\"}],\"devdoc\":{\"author\":\"Lux Network Team\",\"details\":\"Provides core Lamport functionality with initialization and modifier pattern SECURITY MODEL: - Each Lamport key can only sign ONE message (one-time property) - Security based on keccak256 preimage resistance (quantum-safe) - Key rotation via nextPKH commitment pattern See: LP-4105 (Lamport OTS for Lux Safe)\",\"kind\":\"dev\",\"methods\":{\"getPKH()\":{\"returns\":{\"_0\":\"Current pkh\"}},\"init(bytes32)\":{\"params\":{\"firstPKH\":\"Hash of the initial Lamport public key\"}},\"verify_u256(uint256,bytes[256],bytes32[2][256])\":{\"details\":\"Most gas-efficient verification method\",\"params\":{\"bits\":\"The 256-bit message to verify (as uint256)\",\"pub\":\"256x2 array of public key hashes\",\"sig\":\"Array of 256 preimages (revealed private key halves)\"},\"returns\":{\"valid\":\"True if signature is valid\"}}},\"title\":\"LamportBase\",\"version\":1},\"userdoc\":{\"errors\":{\"AlreadyInitialized()\":[{\"notice\":\"Error when trying to initialize twice\"}],\"InvalidLamportSignature()\":[{\"notice\":\"Error when signature verification fails\"}],\"InvalidPublicKeyHash()\":[{\"notice\":\"Error when public key hash doesn't match\"}],\"NotInitialized()\":[{\"notice\":\"Error when not yet initialized\"}]},\"events\":{\"LamportInitialized(bytes32)\":{\"notice\":\"Emitted when contract is initialized\"},\"LamportKeyRotated(bytes32,bytes32)\":{\"notice\":\"Emitted when key is rotated\"}},\"kind\":\"user\",\"methods\":{\"getPKH()\":{\"notice\":\"Get the current public key hash\"},\"init(bytes32)\":{\"notice\":\"Initialize with first Lamport public key hash\"},\"initialized()\":{\"notice\":\"Whether the contract has been initialized with a PKH\"},\"pkh()\":{\"notice\":\"Current Lamport public key hash\"},\"verify_u256(uint256,bytes[256],bytes32[2][256])\":{\"notice\":\"Verify a Lamport signature (256-bit message)\"}},\"notice\":\"Abstract base contract for Lamport signature verification\",\"version\":1}},\"settings\":{\"compilationTarget\":{\"LamportBase.sol\":\"LamportBase\"},\"evmVersion\":\"prague\",\"libraries\":{},\"metadata\":{\"bytecodeHash\":\"ipfs\"},\"optimizer\":{\"enabled\":true,\"runs\":200},\"remappings\":[\":forge-std/=lib/forge-std/src/\"]},\"sources\":{\"LamportBase.sol\":{\"keccak256\":\"0x104d442f76bdea683d2be8a51b862da19e2801db1e61c4c8eec0aaceea8e04fb\",\"license\":\"BSD-3-Clause\",\"urls\":[\"bzz-raw://4651897663733c9b0cb8e1953ed32f4b3c9b48450018da7615eee285f17c44b3\",\"dweb:/ipfs/QmT7kyoSdYd17tgBwzchbci2FGTchpBLvv3nNi7DHeYWML\"]}},\"version\":1}","metadata":{"compiler":{"version":"0.8.31+commit.fd3a2265"},"language":"Solidity","output":{"abi":[{"inputs":[],"type":"error","name":"AlreadyInitialized"},{"inputs":[],"type":"error","name":"InvalidLamportSignature"},{"inputs":[],"type":"error","name":"InvalidPublicKeyHash"},{"inputs":[],"type":"error","name":"NotInitialized"},{"inputs":[{"internalType":"bytes32","name":"initialPkh","type":"bytes32","indexed":true}],"type":"event","name":"LamportInitialized","anonymous":false},{"inputs":[{"internalType":"bytes32","name":"oldPkh","type":"bytes32","indexed":true},{"internalType":"bytes32","name":"newPkh","type":"bytes32","indexed":true}],"type":"event","name":"LamportKeyRotated","anonymous":false},{"inputs":[],"stateMutability":"view","type":"function","name":"getPKH","outputs":[{"internalType":"bytes32","name":"","type":"bytes32"}]},{"inputs":[{"internalType":"bytes32","name":"firstPKH","type":"bytes32"}],"stateMutability":"nonpayable","type":"function","name":"init"},{"inputs":[],"stateMutability":"view","type":"function","name":"initialized","outputs":[{"internalType":"bool","name":"","type":"bool"}]},{"inputs":[],"stateMutability":"view","type":"function","name":"pkh","outputs":[{"internalType":"bytes32","name":"","type":"bytes32"}]},{"inputs":[{"internalType":"uint256","name":"bits","type":"uint256"},{"internalType":"bytes[256]","name":"sig","type":"bytes[256]"},{"internalType":"bytes32[2][256]","name":"pub","type":"bytes32[2][256]"}],"stateMutability":"pure","type":"function","name":"verify_u256","outputs":[{"internalType":"bool","name":"valid","type":"bool"}]}],"devdoc":{"kind":"dev","methods":{"getPKH()":{"returns":{"_0":"Current pkh"}},"init(bytes32)":{"params":{"firstPKH":"Hash of the initial Lamport public key"}},"verify_u256(uint256,bytes[256],bytes32[2][256])":{"details":"Most gas-efficient verification method","params":{"bits":"The 256-bit message to verify (as uint256)","pub":"256x2 array of public key hashes","sig":"Array of 256 preimages (revealed private key halves)"},"returns":{"valid":"True if signature is valid"}}},"version":1},"userdoc":{"kind":"user","methods":{"getPKH()":{"notice":"Get the current public key hash"},"init(bytes32)":{"notice":"Initialize with first Lamport public key hash"},"initialized()":{"notice":"Whether the contract has been initialized with a PKH"},"pkh()":{"notice":"Current Lamport public key hash"},"verify_u256(uint256,bytes[256],bytes32[2][256])":{"notice":"Verify a Lamport signature (256-bit message)"}},"version":1}},"settings":{"remappings":["forge-std/=lib/forge-std/src/"],"optimizer":{"enabled":true,"runs":200},"metadata":{"bytecodeHash":"ipfs"},"compilationTarget":{"LamportBase.sol":"LamportBase"},"evmVersion":"prague","libraries":{}},"sources":{"LamportBase.sol":{"keccak256":"0x104d442f76bdea683d2be8a51b862da19e2801db1e61c4c8eec0aaceea8e04fb","urls":["bzz-raw://4651897663733c9b0cb8e1953ed32f4b3c9b48450018da7615eee285f17c44b3","dweb:/ipfs/QmT7kyoSdYd17tgBwzchbci2FGTchpBLvv3nNi7DHeYWML"],"license":"BSD-3-Clause"}},"version":1},"id":1}