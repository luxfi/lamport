{"abi":[{"type":"function","name":"computeMessage","inputs":[{"name":"safeTxHash","type":"bytes32","internalType":"bytes32"},{"name":"nextPKH","type":"bytes32","internalType":"bytes32"}],"outputs":[{"name":"m","type":"uint256","internalType":"uint256"}],"stateMutability":"view"},{"type":"function","name":"computePKH","inputs":[{"name":"pub","type":"bytes32[2][256]","internalType":"bytes32[2][256]"}],"outputs":[{"name":"pkh","type":"bytes32","internalType":"bytes32"}],"stateMutability":"pure"},{"type":"function","name":"verify","inputs":[{"name":"bits","type":"uint256","internalType":"uint256"},{"name":"sig","type":"bytes[256]","internalType":"bytes[256]"},{"name":"pub","type":"bytes32[2][256]","internalType":"bytes32[2][256]"}],"outputs":[{"name":"valid","type":"bool","internalType":"bool"}],"stateMutability":"pure"},{"type":"function","name":"verifyThreshold","inputs":[{"name":"safeTxHash","type":"bytes32","internalType":"bytes32"},{"name":"nextPKH","type":"bytes32","internalType":"bytes32"},{"name":"sig","type":"bytes[256]","internalType":"bytes[256]"},{"name":"pub","type":"bytes32[2][256]","internalType":"bytes32[2][256]"},{"name":"expectedPKH","type":"bytes32","internalType":"bytes32"}],"outputs":[{"name":"valid","type":"bool","internalType":"bool"}],"stateMutability":"view"},{"type":"function","name":"verifyWithPKH","inputs":[{"name":"bits","type":"uint256","internalType":"uint256"},{"name":"sig","type":"bytes[256]","internalType":"bytes[256]"},{"name":"pub","type":"bytes32[2][256]","internalType":"bytes32[2][256]"},{"name":"expectedPKH","type":"bytes32","internalType":"bytes32"}],"outputs":[{"name":"valid","type":"bool","internalType":"bool"}],"stateMutability":"pure"},{"type":"event","name":"SignatureVerified","inputs":[{"name":"messageHash","type":"bytes32","indexed":true,"internalType":"bytes32"},{"name":"pkh","type":"bytes32","indexed":true,"internalType":"bytes32"},{"name":"valid","type":"bool","indexed":false,"internalType":"bool"}],"anonymous":false},{"type":"error","name":"InvalidPublicKey","inputs":[{"name":"expected","type":"bytes32","internalType":"bytes32"},{"name":"actual","type":"bytes32","internalType":"bytes32"}]},{"type":"error","name":"InvalidSignature","inputs":[]}],"bytecode":{"object":"0x6080604052348015600e575f5ffd5b506106098061001c5f395ff3fe608060405234801561000f575f5ffd5b5060043610610055575f3560e01c8063099ace0914610059578063939b815114610081578063bc7b225514610094578063bf54242c146100b5578063f94d12db146100c8575b5f5ffd5b61006c6100673660046103b5565b6100db565b60405190151581526020015b60405180910390f35b61006c61008f36600461041c565b610176565b6100a76100a236600461047a565b6101e9565b604051908152602001610078565b6100a76100c336600461049a565b6101ff565b61006c6100d63660046104b5565b610248565b6040805161200081019091525f90819061013c908561010084835b82821015610133576040805180820182529080840286019060029083908390808284375f92019190915250505081526001909101906020016100f6565b5050505061025e565b905082811461014e575f91505061016d565b5f61015b8888304661028d565b90506101688187876102de565b925050505b95945050505050565b60408051612040810182525f9182916101c09186906101009085908490612000820190859060029083908390808284375f92019190915250505081526001909101906020016100f6565b90508281146101d2575f9150506101e1565b6101dd8686866102de565b9150505b949350505050565b5f6101f68383304661028d565b90505b92915050565b60408051612040810182525f916101f9919084906101009085908490612000820190859060029083908390808284375f92019190915250505081526001909101906020016100f6565b5f6102548484846102de565b90505b9392505050565b5f81604051602001610270919061050a565b604051602081830303815290604052805190602001209050919050565b60408051602080820196909652808201949094526bffffffffffffffffffffffff19606093841b16928401929092526074808401919091528151808403909101815260949092019052805191012090565b5f5f5b610100811015610388575f5f8260ff036001901b871611610302575f610305565b60015b60ff1690508382610100811061031d5761031d610566565b60400201816002811061033257610332610566565b60200201358583610100811061034a5761034a610566565b60200281019061035a919061057a565b6040516103689291906105c4565b60405180910390201461037f575f92505050610257565b506001016102e1565b506001949350505050565b8061200081018310156101f9575f5ffd5b8061400081018310156101f9575f5ffd5b5f5f5f5f5f61408086880312156103ca575f5ffd5b8535945060208601359350604086013567ffffffffffffffff8111156103ee575f5ffd5b6103fa88828901610393565b93505061040a87606088016103a4565b94979396509194614060013592915050565b5f5f5f5f6140608587031215610430575f5ffd5b84359350602085013567ffffffffffffffff81111561044d575f5ffd5b61045987828801610393565b93505061046986604087016103a4565b939692955092936140400135925050565b5f5f6040838503121561048b575f5ffd5b50508035926020909101359150565b5f61400082840312156104ab575f5ffd5b6101f683836103a4565b5f5f5f61404084860312156104c8575f5ffd5b83359250602084013567ffffffffffffffff8111156104e5575f5ffd5b6104f186828701610393565b92505061050185604086016103a4565b90509250925092565b5f8183825b610100811015610556578151835f5b600281101561053d57825182526020928301929091019060010161051e565b505050604092909201916020919091019060010161050f565b5050506140008201905092915050565b634e487b7160e01b5f52603260045260245ffd5b5f5f8335601e1984360301811261058f575f5ffd5b83018035915067ffffffffffffffff8211156105a9575f5ffd5b6020019150368190038213156105bd575f5ffd5b9250929050565b818382375f910190815291905056fea26469706673582212201fa27ff4a2843fa7f0d14e1a4ab39c74569fdf2f63d37b9fcbc3d00aff634eb164736f6c634300081f0033","sourceMap":"517:4989:7:-:0;;;;;;;;;;;;;;;;;;;","linkReferences":{}},"deployedBytecode":{"object":"0x608060405234801561000f575f5ffd5b5060043610610055575f3560e01c8063099ace0914610059578063939b815114610081578063bc7b225514610094578063bf54242c146100b5578063f94d12db146100c8575b5f5ffd5b61006c6100673660046103b5565b6100db565b60405190151581526020015b60405180910390f35b61006c61008f36600461041c565b610176565b6100a76100a236600461047a565b6101e9565b604051908152602001610078565b6100a76100c336600461049a565b6101ff565b61006c6100d63660046104b5565b610248565b6040805161200081019091525f90819061013c908561010084835b82821015610133576040805180820182529080840286019060029083908390808284375f92019190915250505081526001909101906020016100f6565b5050505061025e565b905082811461014e575f91505061016d565b5f61015b8888304661028d565b90506101688187876102de565b925050505b95945050505050565b60408051612040810182525f9182916101c09186906101009085908490612000820190859060029083908390808284375f92019190915250505081526001909101906020016100f6565b90508281146101d2575f9150506101e1565b6101dd8686866102de565b9150505b949350505050565b5f6101f68383304661028d565b90505b92915050565b60408051612040810182525f916101f9919084906101009085908490612000820190859060029083908390808284375f92019190915250505081526001909101906020016100f6565b5f6102548484846102de565b90505b9392505050565b5f81604051602001610270919061050a565b604051602081830303815290604052805190602001209050919050565b60408051602080820196909652808201949094526bffffffffffffffffffffffff19606093841b16928401929092526074808401919091528151808403909101815260949092019052805191012090565b5f5f5b610100811015610388575f5f8260ff036001901b871611610302575f610305565b60015b60ff1690508382610100811061031d5761031d610566565b60400201816002811061033257610332610566565b60200201358583610100811061034a5761034a610566565b60200281019061035a919061057a565b6040516103689291906105c4565b60405180910390201461037f575f92505050610257565b506001016102e1565b506001949350505050565b8061200081018310156101f9575f5ffd5b8061400081018310156101f9575f5ffd5b5f5f5f5f5f61408086880312156103ca575f5ffd5b8535945060208601359350604086013567ffffffffffffffff8111156103ee575f5ffd5b6103fa88828901610393565b93505061040a87606088016103a4565b94979396509194614060013592915050565b5f5f5f5f6140608587031215610430575f5ffd5b84359350602085013567ffffffffffffffff81111561044d575f5ffd5b61045987828801610393565b93505061046986604087016103a4565b939692955092936140400135925050565b5f5f6040838503121561048b575f5ffd5b50508035926020909101359150565b5f61400082840312156104ab575f5ffd5b6101f683836103a4565b5f5f5f61404084860312156104c8575f5ffd5b83359250602084013567ffffffffffffffff8111156104e5575f5ffd5b6104f186828701610393565b92505061050185604086016103a4565b90509250925092565b5f8183825b610100811015610556578151835f5b600281101561053d57825182526020928301929091019060010161051e565b505050604092909201916020919091019060010161050f565b5050506140008201905092915050565b634e487b7160e01b5f52603260045260245ffd5b5f5f8335601e1984360301811261058f575f5ffd5b83018035915067ffffffffffffffff8211156105a9575f5ffd5b6020019150368190038213156105bd575f5ffd5b9250929050565b818382375f910190815291905056fea26469706673582212201fa27ff4a2843fa7f0d14e1a4ab39c74569fdf2f63d37b9fcbc3d00aff634eb164736f6c634300081f0033","sourceMap":"517:4989:7:-:0;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;3979:671;;;;;;:::i;:::-;;:::i;:::-;;;1437:14:28;;1430:22;1412:41;;1400:2;1385:18;3979:671:7;;;;;;;;3153:442;;;;;;:::i;:::-;;:::i;5220:284::-;;;;;;:::i;:::-;;:::i;:::-;;;2744:25:28;;;2732:2;2717:18;5220:284:7;2598:177:28;4843:150:7;;;;;;:::i;:::-;;:::i;2592:212::-;;;;;;:::i;:::-;;:::i;3979:671::-;4250:26;;;;;;;;;4186:10;;;;4250:26;;4272:3;4250:26;4186:10;4250:26;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;-1:-1:-1;;;4250:26:7;;;;;;;;;;;;;;;;:21;:26::i;:::-;4230:46;;4303:11;4290:9;:24;4286:67;;4337:5;4330:12;;;;;4286:67;4407:9;4419:143;4467:10;4491:7;4520:4;4539:13;4419:34;:143::i;:::-;4407:155;;4608:35;4631:1;4634:3;4639;4608:22;:35::i;:::-;4601:42;;;;3979:671;;;;;;;;:::o;3153:442::-;3397:26;;;;;;;;-1:-1:-1;;;;3397:26:7;;3419:3;;3397:26;;-1:-1:-1;;3397:26:7;;;;;;3419:3;;3397:26;;;;3419:3;;3397:26;3419:3;3397:26;;;;;;;;;-1:-1:-1;;;3397:26:7;;;;;;;;;;;;3377:46;;3450:11;3437:9;:24;3433:67;;3484:5;3477:12;;;;;3433:67;3550:38;3573:4;3579:3;3584;3550:22;:38::i;:::-;3543:45;;;3153:442;;;;;;;:::o;5220:284::-;5326:9;5354:143;5402:10;5426:7;5455:4;5474:13;5354:34;:143::i;:::-;5347:150;;5220:284;;;;;:::o;4843:150::-;4960:26;;;;;;;;-1:-1:-1;;4960:26:7;;;4982:3;;4960:26;;-1:-1:-1;;4960:26:7;;;;;;4982:3;;4960:26;;;;4982:3;;4960:26;4982:3;4960:26;;;;;;;;;-1:-1:-1;;;4960:26:7;;;;;;;;;;;2592:212;2730:10;2759:38;2782:4;2788:3;2793;2759:22;:38::i;:::-;2752:45;;2592:212;;;;;;:::o;3689:166:3:-;3780:11;3837:9;3820:27;;;;;;;;:::i;:::-;;;;;;;;;;;;;3810:38;;;;;;3803:45;;3689:166;;;:::o;4318:331::-;4528:112;;;;;;;4991:19:28;;;;5026:12;;;5019:28;;;;-1:-1:-1;;5085:2:28;5081:15;;;5077:53;5063:12;;;5056:75;;;;5147:12;;;;5140:28;;;;4528:112:3;;;;;;;;;;5184:13:28;;;;4528:112:3;;4518:123;;;;;;4318:331::o;922:647::-;1065:10;1116:9;1111:417;1131:3;1127:1;:7;1111:417;;;1292:11;1335:1;1328;1322:3;:7;1316:1;:14;;1308:4;:23;1307:29;1306:39;;1344:1;1306:39;;;1340:1;1306:39;1292:53;;;;1448:3;1452:1;1448:6;;;;;;;:::i;:::-;;;;1455:3;1448:11;;;;;;;:::i;:::-;;;;;1437:3;1441:1;1437:6;;;;;;;:::i;:::-;;;;;;;;;;:::i;:::-;1427:17;;;;;;;:::i;:::-;;;;;;;;:32;1423:91;;1490:5;1483:12;;;;;;1423:91;-1:-1:-1;1136:3:3;;1111:417;;;-1:-1:-1;1548:4:3;;922:647;-1:-1:-1;;;;922:647:3:o;14:168:28:-;115:6;148:4;136:17;;133:26;-1:-1:-1;130:46:28;;;172:1;169;162:12;187:177;296:6;329:5;317:18;;314:27;-1:-1:-1;311:47:28;;;354:1;351;344:12;369:898;554:6;562;570;578;586;639:5;627:9;618:7;614:23;610:35;607:55;;;658:1;655;648:12;607:55;703:23;;;-1:-1:-1;823:2:28;808:18;;795:32;;-1:-1:-1;904:2:28;889:18;;876:32;931:18;920:30;;917:50;;;963:1;960;953:12;917:50;986:73;1051:7;1042:6;1031:9;1027:22;986:73;:::i;:::-;976:83;;;1078:77;1147:7;1142:2;1131:9;1127:18;1078:77;:::i;:::-;369:898;;;;-1:-1:-1;369:898:28;;1228:5;1213:21;1200:35;;369:898;-1:-1:-1;;369:898:28:o;1464:778::-;1640:6;1648;1656;1664;1717:5;1705:9;1696:7;1692:23;1688:35;1685:55;;;1736:1;1733;1726:12;1685:55;1781:23;;;-1:-1:-1;1879:2:28;1864:18;;1851:32;1906:18;1895:30;;1892:50;;;1938:1;1935;1928:12;1892:50;1961:73;2026:7;2017:6;2006:9;2002:22;1961:73;:::i;:::-;1951:83;;;2053:77;2122:7;2117:2;2106:9;2102:18;2053:77;:::i;:::-;1464:778;;;;-1:-1:-1;2043:87:28;;2203:5;2188:21;2175:35;;-1:-1:-1;;1464:778:28:o;2247:346::-;2315:6;2323;2376:2;2364:9;2355:7;2351:23;2347:32;2344:52;;;2392:1;2389;2382:12;2344:52;-1:-1:-1;;2437:23:28;;;2557:2;2542:18;;;2529:32;;-1:-1:-1;2247:346:28:o;2780:280::-;2891:6;2944:5;2932:9;2923:7;2919:23;2915:35;2912:55;;;2963:1;2960;2953:12;2912:55;2986:68;3046:7;3035:9;2986:68;:::i;3247:655::-;3414:6;3422;3430;3483:5;3471:9;3462:7;3458:23;3454:35;3451:55;;;3502:1;3499;3492:12;3451:55;3547:23;;;-1:-1:-1;3645:2:28;3630:18;;3617:32;3672:18;3661:30;;3658:50;;;3704:1;3701;3694:12;3658:50;3727:73;3792:7;3783:6;3772:9;3768:22;3727:73;:::i;:::-;3717:83;;;3819:77;3888:7;3883:2;3872:9;3868:18;3819:77;:::i;:::-;3809:87;;3247:655;;;;;:::o;3907:866::-;4114:3;4145;4192:6;4114:3;4226:510;4240:6;4237:1;4234:13;4226:510;;;4299:13;;4338:5;4425:1;4439:209;4455:4;4450:3;4447:13;4439:209;;;4528:15;;4514:30;;4581:4;4615:19;;;;4570:16;;;;4479:1;4470:11;4439:209;;;-1:-1:-1;;;4681:4:28;4670:16;;;;;4721:4;4709:17;;;;;4262:1;4255:9;4226:510;;;4230:3;;;4761:5;4756:3;4752:15;4745:22;;3907:866;;;;:::o;5208:127::-;5269:10;5264:3;5260:20;5257:1;5250:31;5300:4;5297:1;5290:15;5324:4;5321:1;5314:15;5340:521;5417:4;5423:6;5483:11;5470:25;5577:2;5573:7;5562:8;5546:14;5542:29;5538:43;5518:18;5514:68;5504:96;;5596:1;5593;5586:12;5504:96;5623:33;;5675:20;;;-1:-1:-1;5718:18:28;5707:30;;5704:50;;;5750:1;5747;5740:12;5704:50;5783:4;5771:17;;-1:-1:-1;5814:14:28;5810:27;;;5800:38;;5797:58;;;5851:1;5848;5841:12;5797:58;5340:521;;;;;:::o;5866:271::-;6049:6;6041;6036:3;6023:33;6005:3;6075:16;;6100:13;;;6075:16;5866:271;-1:-1:-1;5866:271:28:o","linkReferences":{}},"methodIdentifiers":{"computeMessage(bytes32,bytes32)":"bc7b2255","computePKH(bytes32[2][256])":"bf54242c","verify(uint256,bytes[256],bytes32[2][256])":"f94d12db","verifyThreshold(bytes32,bytes32,bytes[256],bytes32[2][256],bytes32)":"099ace09","verifyWithPKH(uint256,bytes[256],bytes32[2][256],bytes32)":"939b8151"},"rawMetadata":"{\"compiler\":{\"version\":\"0.8.31+commit.fd3a2265\"},\"language\":\"Solidity\",\"output\":{\"abi\":[{\"inputs\":[{\"internalType\":\"bytes32\",\"name\":\"expected\",\"type\":\"bytes32\"},{\"internalType\":\"bytes32\",\"name\":\"actual\",\"type\":\"bytes32\"}],\"name\":\"InvalidPublicKey\",\"type\":\"error\"},{\"inputs\":[],\"name\":\"InvalidSignature\",\"type\":\"error\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":true,\"internalType\":\"bytes32\",\"name\":\"messageHash\",\"type\":\"bytes32\"},{\"indexed\":true,\"internalType\":\"bytes32\",\"name\":\"pkh\",\"type\":\"bytes32\"},{\"indexed\":false,\"internalType\":\"bool\",\"name\":\"valid\",\"type\":\"bool\"}],\"name\":\"SignatureVerified\",\"type\":\"event\"},{\"inputs\":[{\"internalType\":\"bytes32\",\"name\":\"safeTxHash\",\"type\":\"bytes32\"},{\"internalType\":\"bytes32\",\"name\":\"nextPKH\",\"type\":\"bytes32\"}],\"name\":\"computeMessage\",\"outputs\":[{\"internalType\":\"uint256\",\"name\":\"m\",\"type\":\"uint256\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"bytes32[2][256]\",\"name\":\"pub\",\"type\":\"bytes32[2][256]\"}],\"name\":\"computePKH\",\"outputs\":[{\"internalType\":\"bytes32\",\"name\":\"pkh\",\"type\":\"bytes32\"}],\"stateMutability\":\"pure\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"uint256\",\"name\":\"bits\",\"type\":\"uint256\"},{\"internalType\":\"bytes[256]\",\"name\":\"sig\",\"type\":\"bytes[256]\"},{\"internalType\":\"bytes32[2][256]\",\"name\":\"pub\",\"type\":\"bytes32[2][256]\"}],\"name\":\"verify\",\"outputs\":[{\"internalType\":\"bool\",\"name\":\"valid\",\"type\":\"bool\"}],\"stateMutability\":\"pure\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"bytes32\",\"name\":\"safeTxHash\",\"type\":\"bytes32\"},{\"internalType\":\"bytes32\",\"name\":\"nextPKH\",\"type\":\"bytes32\"},{\"internalType\":\"bytes[256]\",\"name\":\"sig\",\"type\":\"bytes[256]\"},{\"internalType\":\"bytes32[2][256]\",\"name\":\"pub\",\"type\":\"bytes32[2][256]\"},{\"internalType\":\"bytes32\",\"name\":\"expectedPKH\",\"type\":\"bytes32\"}],\"name\":\"verifyThreshold\",\"outputs\":[{\"internalType\":\"bool\",\"name\":\"valid\",\"type\":\"bool\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"uint256\",\"name\":\"bits\",\"type\":\"uint256\"},{\"internalType\":\"bytes[256]\",\"name\":\"sig\",\"type\":\"bytes[256]\"},{\"internalType\":\"bytes32[2][256]\",\"name\":\"pub\",\"type\":\"bytes32[2][256]\"},{\"internalType\":\"bytes32\",\"name\":\"expectedPKH\",\"type\":\"bytes32\"}],\"name\":\"verifyWithPKH\",\"outputs\":[{\"internalType\":\"bool\",\"name\":\"valid\",\"type\":\"bool\"}],\"stateMutability\":\"pure\",\"type\":\"function\"}],\"devdoc\":{\"author\":\"Lux Network Team\",\"details\":\"Deploy this on any EVM chain for Lamport verification This contract provides: - PKH-based verification (store 32 bytes, verify against full key) - Direct verification with full public key - Key rotation tracking See: LP-4105 (Lamport OTS for Lux Safe)\",\"kind\":\"dev\",\"methods\":{\"computeMessage(bytes32,bytes32)\":{\"params\":{\"nextPKH\":\"Hash of next public key\",\"safeTxHash\":\"The Safe transaction hash\"},\"returns\":{\"m\":\"The message to sign (as uint256)\"}},\"computePKH(bytes32[2][256])\":{\"params\":{\"pub\":\"256x2 array of public key hashes\"},\"returns\":{\"pkh\":\"The keccak256 hash of the public key\"}},\"verify(uint256,bytes[256],bytes32[2][256])\":{\"params\":{\"bits\":\"The 256-bit message (as uint256)\",\"pub\":\"256x2 array of public key hashes\",\"sig\":\"Array of 256 preimages\"},\"returns\":{\"valid\":\"True if signature is valid\"}},\"verifyThreshold(bytes32,bytes32,bytes[256],bytes32[2][256],bytes32)\":{\"params\":{\"expectedPKH\":\"Expected current public key hash\",\"nextPKH\":\"Hash of next public key\",\"pub\":\"256x2 array of public key hashes\",\"safeTxHash\":\"The Safe transaction hash\",\"sig\":\"Array of 256 preimages\"},\"returns\":{\"valid\":\"True if signature is valid\"}},\"verifyWithPKH(uint256,bytes[256],bytes32[2][256],bytes32)\":{\"params\":{\"bits\":\"The 256-bit message (as uint256)\",\"expectedPKH\":\"Expected public key hash\",\"pub\":\"256x2 array of public key hashes\",\"sig\":\"Array of 256 preimages\"},\"returns\":{\"valid\":\"True if signature is valid AND PKH matches\"}}},\"title\":\"LamportVerifier\",\"version\":1},\"userdoc\":{\"errors\":{\"InvalidPublicKey(bytes32,bytes32)\":[{\"notice\":\"Error when public key doesn't match expected PKH\"}],\"InvalidSignature()\":[{\"notice\":\"Error when signature verification fails\"}]},\"events\":{\"SignatureVerified(bytes32,bytes32,bool)\":{\"notice\":\"Emitted when a signature is verified\"}},\"kind\":\"user\",\"methods\":{\"computeMessage(bytes32,bytes32)\":{\"notice\":\"Compute threshold message hash (for off-chain signing)\"},\"computePKH(bytes32[2][256])\":{\"notice\":\"Compute PKH from public key (view function for off-chain use)\"},\"verify(uint256,bytes[256],bytes32[2][256])\":{\"notice\":\"Verify a Lamport signature with uint256 message format\"},\"verifyThreshold(bytes32,bytes32,bytes[256],bytes32[2][256],bytes32)\":{\"notice\":\"Verify a threshold Lamport signature with domain separation\"},\"verifyWithPKH(uint256,bytes[256],bytes32[2][256],bytes32)\":{\"notice\":\"Verify with PKH check (ensures public key matches stored hash)\"}},\"notice\":\"Standalone Lamport signature verifier contract\",\"version\":1}},\"settings\":{\"compilationTarget\":{\"LamportVerifier.sol\":\"LamportVerifier\"},\"evmVersion\":\"prague\",\"libraries\":{},\"metadata\":{\"bytecodeHash\":\"ipfs\"},\"optimizer\":{\"enabled\":true,\"runs\":200},\"remappings\":[\":forge-std/=lib/forge-std/src/\"]},\"sources\":{\"LamportLib.sol\":{\"keccak256\":\"0xa65789fd5629b6aba8bc40412c96859423177af1aaf3dc04148ce24e4983b8c4\",\"license\":\"BSD-3-Clause\",\"urls\":[\"bzz-raw://099d5a47b2f4aacfd7283d9bb2943af4e2a0b857ed03abceea8d2a9311202702\",\"dweb:/ipfs/QmWx4k5zqtqt7Ydk7uwP7kwc74JM4F4uSmHQCrMccHng4v\"]},\"LamportVerifier.sol\":{\"keccak256\":\"0xe85252b2312e3beafd5fa1f17c6a069826964b65fd7bc538bac513ef7ce0c592\",\"license\":\"BSD-3-Clause\",\"urls\":[\"bzz-raw://059175c823f6fff293465704f2ce91ce37db32a7b43961c57fc2ca782d16e5eb\",\"dweb:/ipfs/QmXNjoaQbBEMXZZ2wFQoTPuNUAF1ju41qUok869dooqrRE\"]}},\"version\":1}","metadata":{"compiler":{"version":"0.8.31+commit.fd3a2265"},"language":"Solidity","output":{"abi":[{"inputs":[{"internalType":"bytes32","name":"expected","type":"bytes32"},{"internalType":"bytes32","name":"actual","type":"bytes32"}],"type":"error","name":"InvalidPublicKey"},{"inputs":[],"type":"error","name":"InvalidSignature"},{"inputs":[{"internalType":"bytes32","name":"messageHash","type":"bytes32","indexed":true},{"internalType":"bytes32","name":"pkh","type":"bytes32","indexed":true},{"internalType":"bool","name":"valid","type":"bool","indexed":false}],"type":"event","name":"SignatureVerified","anonymous":false},{"inputs":[{"internalType":"bytes32","name":"safeTxHash","type":"bytes32"},{"internalType":"bytes32","name":"nextPKH","type":"bytes32"}],"stateMutability":"view","type":"function","name":"computeMessage","outputs":[{"internalType":"uint256","name":"m","type":"uint256"}]},{"inputs":[{"internalType":"bytes32[2][256]","name":"pub","type":"bytes32[2][256]"}],"stateMutability":"pure","type":"function","name":"computePKH","outputs":[{"internalType":"bytes32","name":"pkh","type":"bytes32"}]},{"inputs":[{"internalType":"uint256","name":"bits","type":"uint256"},{"internalType":"bytes[256]","name":"sig","type":"bytes[256]"},{"internalType":"bytes32[2][256]","name":"pub","type":"bytes32[2][256]"}],"stateMutability":"pure","type":"function","name":"verify","outputs":[{"internalType":"bool","name":"valid","type":"bool"}]},{"inputs":[{"internalType":"bytes32","name":"safeTxHash","type":"bytes32"},{"internalType":"bytes32","name":"nextPKH","type":"bytes32"},{"internalType":"bytes[256]","name":"sig","type":"bytes[256]"},{"internalType":"bytes32[2][256]","name":"pub","type":"bytes32[2][256]"},{"internalType":"bytes32","name":"expectedPKH","type":"bytes32"}],"stateMutability":"view","type":"function","name":"verifyThreshold","outputs":[{"internalType":"bool","name":"valid","type":"bool"}]},{"inputs":[{"internalType":"uint256","name":"bits","type":"uint256"},{"internalType":"bytes[256]","name":"sig","type":"bytes[256]"},{"internalType":"bytes32[2][256]","name":"pub","type":"bytes32[2][256]"},{"internalType":"bytes32","name":"expectedPKH","type":"bytes32"}],"stateMutability":"pure","type":"function","name":"verifyWithPKH","outputs":[{"internalType":"bool","name":"valid","type":"bool"}]}],"devdoc":{"kind":"dev","methods":{"computeMessage(bytes32,bytes32)":{"params":{"nextPKH":"Hash of next public key","safeTxHash":"The Safe transaction hash"},"returns":{"m":"The message to sign (as uint256)"}},"computePKH(bytes32[2][256])":{"params":{"pub":"256x2 array of public key hashes"},"returns":{"pkh":"The keccak256 hash of the public key"}},"verify(uint256,bytes[256],bytes32[2][256])":{"params":{"bits":"The 256-bit message (as uint256)","pub":"256x2 array of public key hashes","sig":"Array of 256 preimages"},"returns":{"valid":"True if signature is valid"}},"verifyThreshold(bytes32,bytes32,bytes[256],bytes32[2][256],bytes32)":{"params":{"expectedPKH":"Expected current public key hash","nextPKH":"Hash of next public key","pub":"256x2 array of public key hashes","safeTxHash":"The Safe transaction hash","sig":"Array of 256 preimages"},"returns":{"valid":"True if signature is valid"}},"verifyWithPKH(uint256,bytes[256],bytes32[2][256],bytes32)":{"params":{"bits":"The 256-bit message (as uint256)","expectedPKH":"Expected public key hash","pub":"256x2 array of public key hashes","sig":"Array of 256 preimages"},"returns":{"valid":"True if signature is valid AND PKH matches"}}},"version":1},"userdoc":{"kind":"user","methods":{"computeMessage(bytes32,bytes32)":{"notice":"Compute threshold message hash (for off-chain signing)"},"computePKH(bytes32[2][256])":{"notice":"Compute PKH from public key (view function for off-chain use)"},"verify(uint256,bytes[256],bytes32[2][256])":{"notice":"Verify a Lamport signature with uint256 message format"},"verifyThreshold(bytes32,bytes32,bytes[256],bytes32[2][256],bytes32)":{"notice":"Verify a threshold Lamport signature with domain separation"},"verifyWithPKH(uint256,bytes[256],bytes32[2][256],bytes32)":{"notice":"Verify with PKH check (ensures public key matches stored hash)"}},"version":1}},"settings":{"remappings":["forge-std/=lib/forge-std/src/"],"optimizer":{"enabled":true,"runs":200},"metadata":{"bytecodeHash":"ipfs"},"compilationTarget":{"LamportVerifier.sol":"LamportVerifier"},"evmVersion":"prague","libraries":{}},"sources":{"LamportLib.sol":{"keccak256":"0xa65789fd5629b6aba8bc40412c96859423177af1aaf3dc04148ce24e4983b8c4","urls":["bzz-raw://099d5a47b2f4aacfd7283d9bb2943af4e2a0b857ed03abceea8d2a9311202702","dweb:/ipfs/QmWx4k5zqtqt7Ydk7uwP7kwc74JM4F4uSmHQCrMccHng4v"],"license":"BSD-3-Clause"},"LamportVerifier.sol":{"keccak256":"0xe85252b2312e3beafd5fa1f17c6a069826964b65fd7bc538bac513ef7ce0c592","urls":["bzz-raw://059175c823f6fff293465704f2ce91ce37db32a7b43961c57fc2ca782d16e5eb","dweb:/ipfs/QmXNjoaQbBEMXZZ2wFQoTPuNUAF1ju41qUok869dooqrRE"],"license":"BSD-3-Clause"}},"version":1},"id":7}