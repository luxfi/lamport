{"abi":[{"type":"constructor","inputs":[{"name":"_safe","type":"address","internalType":"address"}],"stateMutability":"nonpayable"},{"type":"function","name":"computeMessageHash","inputs":[{"name":"to","type":"address","internalType":"address"},{"name":"value","type":"uint256","internalType":"uint256"},{"name":"data","type":"bytes","internalType":"bytes"},{"name":"operation","type":"uint8","internalType":"uint8"},{"name":"nextPKH","type":"bytes32","internalType":"bytes32"}],"outputs":[{"name":"m","type":"uint256","internalType":"uint256"}],"stateMutability":"view"},{"type":"function","name":"exec","inputs":[{"name":"to","type":"address","internalType":"address"},{"name":"value","type":"uint256","internalType":"uint256"},{"name":"data","type":"bytes","internalType":"bytes"},{"name":"sig","type":"bytes[256]","internalType":"bytes[256]"},{"name":"currentPub","type":"bytes32[2][256]","internalType":"bytes32[2][256]"},{"name":"nextPKH","type":"bytes32","internalType":"bytes32"}],"outputs":[{"name":"success","type":"bool","internalType":"bool"}],"stateMutability":"nonpayable"},{"type":"function","name":"execWithLamport","inputs":[{"name":"to","type":"address","internalType":"address"},{"name":"value","type":"uint256","internalType":"uint256"},{"name":"data","type":"bytes","internalType":"bytes"},{"name":"operation","type":"uint8","internalType":"uint8"},{"name":"sig","type":"bytes[256]","internalType":"bytes[256]"},{"name":"currentPub","type":"bytes32[2][256]","internalType":"bytes32[2][256]"},{"name":"nextPKH","type":"bytes32","internalType":"bytes32"}],"outputs":[{"name":"success","type":"bool","internalType":"bool"}],"stateMutability":"nonpayable"},{"type":"function","name":"getPKH","inputs":[],"outputs":[{"name":"","type":"bytes32","internalType":"bytes32"}],"stateMutability":"view"},{"type":"function","name":"init","inputs":[{"name":"initialPkh","type":"bytes32","internalType":"bytes32"}],"outputs":[],"stateMutability":"nonpayable"},{"type":"function","name":"initialized","inputs":[],"outputs":[{"name":"","type":"bool","internalType":"bool"}],"stateMutability":"view"},{"type":"function","name":"isInitialized","inputs":[],"outputs":[{"name":"","type":"bool","internalType":"bool"}],"stateMutability":"view"},{"type":"function","name":"lamportNonce","inputs":[],"outputs":[{"name":"","type":"uint256","internalType":"uint256"}],"stateMutability":"view"},{"type":"function","name":"pkh","inputs":[],"outputs":[{"name":"","type":"bytes32","internalType":"bytes32"}],"stateMutability":"view"},{"type":"function","name":"safe","inputs":[],"outputs":[{"name":"","type":"address","internalType":"address"}],"stateMutability":"view"},{"type":"event","name":"LamportExecuted","inputs":[{"name":"safeTxHash","type":"bytes32","indexed":true,"internalType":"bytes32"},{"name":"nextPkh","type":"bytes32","indexed":true,"internalType":"bytes32"},{"name":"nonce","type":"uint256","indexed":false,"internalType":"uint256"}],"anonymous":false},{"type":"event","name":"LamportInitialized","inputs":[{"name":"initialPkh","type":"bytes32","indexed":true,"internalType":"bytes32"}],"anonymous":false},{"type":"event","name":"LamportKeyRotated","inputs":[{"name":"oldPkh","type":"bytes32","indexed":true,"internalType":"bytes32"},{"name":"newPkh","type":"bytes32","indexed":true,"internalType":"bytes32"}],"anonymous":false},{"type":"error","name":"AlreadyInitialized","inputs":[]},{"type":"error","name":"InvalidLamportSignature","inputs":[]},{"type":"error","name":"InvalidPublicKey","inputs":[]},{"type":"error","name":"NotInitialized","inputs":[]},{"type":"error","name":"OnlySafe","inputs":[]}],"bytecode":{"object":"0x60a060405234801561000f575f5ffd5b50604051610e8f380380610e8f83398101604081905261002e91610099565b6001600160a01b0381166100885760405162461bcd60e51b815260206004820152601b60248201527f4c616d706f72744d6f64756c653a207a65726f20616464726573730000000000604482015260640160405180910390fd5b6001600160a01b03166080526100c6565b5f602082840312156100a9575f5ffd5b81516001600160a01b03811681146100bf575f5ffd5b9392505050565b608051610d966100f95f395f818160c60152818161018a0152818161027b0152818161046a01526105b40152610d965ff3fe608060405234801561000f575f5ffd5b506004361061009b575f3560e01c80635f384225116100635780635f3842251461013657806366a47bfb146101495780636a685e3a1461015c5780636ed10fbb14610165578063cd0fb1b31461016c575f5ffd5b8063158ef93e1461009f578063186f0354146100c1578063392e53cd146101005780633b6631951461010b5780633cbf389314610120575b5f5ffd5b6001546100ac9060ff1681565b60405190151581526020015b60405180910390f35b6100e87f000000000000000000000000000000000000000000000000000000000000000081565b6040516001600160a01b0390911681526020016100b8565b60015460ff166100ac565b61011e6101193660046107a2565b61017f565b005b6101285f5481565b6040519081526020016100b8565b610128610144366004610829565b610277565b6100ac6101573660046108c5565b610334565b61012860025481565b5f54610128565b6100ac61017a366004610967565b6103a7565b336001600160a01b037f000000000000000000000000000000000000000000000000000000000000000016146101c85760405163d7fed6bd60e01b815260040160405180910390fd5b60015460ff16156101eb5760405162dc149f60e41b815260040160405180910390fd5b8061023c5760405162461bcd60e51b815260206004820152601760248201527f4c616d706f72744d6f64756c653a207a65726f20504b48000000000000000000604482015260640160405180910390fd5b5f8181556001805460ff19168117905560405182917ff83bf9e0a6257495710d3a8dd8849575a48f412e4e06b158ab01360d30dc290291a250565b5f5f7f00000000000000000000000000000000000000000000000000000000000000006001600160a01b031663d8d11f7889898989895f5f5f5f5f6002546040518c63ffffffff1660e01b81526004016102db9b9a99989796959493929190610a41565b602060405180830381865afa1580156102f6573d5f5f3e3d5ffd5b505050506040513d601f19601f8201168201806040525081019061031a9190610ab4565b90506103288184304661066b565b98975050505050505050565b60405163cd0fb1b360e01b81525f90309063cd0fb1b390610367908b908b908b908b9088908c908c908c90600401610af6565b6020604051808303815f875af1158015610383573d5f5f3e3d5ffd5b505050506040513d601f19601f820116820180604052508101906103289190610bd7565b6001545f9060ff166103cc576040516321c4e35760e21b815260040160405180910390fd5b6040805161200081019091525f9061042b908561010084835b82821015610422576040805180820182529080840286019060029083908390808284375f92019190915250505081526001909101906020016103e5565b505050506106bc565b90505f54811461044e5760405163145a1fdd60e31b815260040160405180910390fd5b600254604051631b1a23ef60e31b81525f916001600160a01b037f0000000000000000000000000000000000000000000000000000000000000000169163d8d11f78916104b1918f918f918f918f918f918a918291829182918291600401610a41565b602060405180830381865afa1580156104cc573d5f5f3e3d5ffd5b505050506040513d601f19601f820116820180604052508101906104f09190610ab4565b90505f6104ff8286304661066b565b905061050c8188886106eb565b61052957604051630dbc2bdf60e11b815260040160405180910390fd5b5f805486825560028054919261053e83610c0a565b9091555050604051869082907f7abd04341ca4fa109bdfe5f4350efb88488e5a9253db95d3b19d1ff6592b361e905f90a385837ffd39c0345819c8cb423e22447cb682f42d870deabfd1b5c5981bdd0b7aac2fc960016002546105a19190610c22565b60405190815260200160405180910390a37f00000000000000000000000000000000000000000000000000000000000000006001600160a01b031663468721a78e8e8e8e8e60ff1660018111156105fa576105fa610c35565b6040518663ffffffff1660e01b815260040161061a959493929190610c49565b6020604051808303815f875af1158015610636573d5f5f3e3d5ffd5b505050506040513d601f19601f8201168201806040525081019061065a9190610bd7565b9d9c50505050505050505050505050565b60408051602080820196909652808201949094526bffffffffffffffffffffffff19606093841b16928401929092526074808401919091528151808403909101815260949092019052805191012090565b5f816040516020016106ce9190610c9e565b604051602081830303815290604052805190602001209050919050565b5f5f5b610100811015610795575f5f8260ff036001901b87161161070f575f610712565b60015b60ff1690508382610100811061072a5761072a610cfa565b60400201816002811061073f5761073f610cfa565b60200201358583610100811061075757610757610cfa565b6020028101906107679190610d0e565b604051610775929190610d51565b60405180910390201461078c575f9250505061079b565b506001016106ee565b50600190505b9392505050565b5f602082840312156107b2575f5ffd5b5035919050565b80356001600160a01b03811681146107cf575f5ffd5b919050565b5f5f83601f8401126107e4575f5ffd5b50813567ffffffffffffffff8111156107fb575f5ffd5b602083019150836020828501011115610812575f5ffd5b9250929050565b803560ff811681146107cf575f5ffd5b5f5f5f5f5f5f60a0878903121561083e575f5ffd5b610847876107b9565b955060208701359450604087013567ffffffffffffffff811115610869575f5ffd5b61087589828a016107d4565b9095509350610888905060608801610819565b95989497509295919493608090920135925050565b8061200081018310156108ae575f5ffd5b92915050565b8061400081018310156108ae575f5ffd5b5f5f5f5f5f5f5f6140a0888a0312156108dc575f5ffd5b6108e5886107b9565b965060208801359550604088013567ffffffffffffffff811115610907575f5ffd5b6109138a828b016107d4565b909650945050606088013567ffffffffffffffff811115610932575f5ffd5b61093e8a828b0161089d565b93505061094e8960808a016108b4565b9699959850939692959194919350506140809091013590565b5f5f5f5f5f5f5f5f6140c0898b03121561097f575f5ffd5b610988896107b9565b975060208901359650604089013567ffffffffffffffff8111156109aa575f5ffd5b6109b68b828c016107d4565b90975095506109c9905060608a01610819565b9350608089013567ffffffffffffffff8111156109e4575f5ffd5b6109f08b828c0161089d565b935050610a008a60a08b016108b4565b979a96995094979396929591945091926140a001359150565b81835281816020850137505f828201602090810191909152601f909101601f19169091010190565b60018060a01b038c1681528a602082015261014060408201525f610a6a61014083018b8d610a19565b60ff99909916606083015250608081019690965260a086019490945260c08501929092526001600160a01b0390811660e08501521661010083015261012090910152949350505050565b5f60208284031215610ac4575f5ffd5b5051919050565b805f5b610100811015610af05760408285376040938401939190910190600101610ace565b50505050565b60018060a01b03891681528760208201526140c060408201525f610b1f6140c08301888a610a19565b60ff871660608401528281036080840152806120008101875f36829003601e19015b610100821015610bad5785840385528235818112610b5d575f5ffd5b8b0160208101903567ffffffffffffffff811115610b79575f5ffd5b803603821315610b87575f5ffd5b610b92868284610a19565b95505050602083019250602085019450600182019150610b41565b505050809350505050610bc360a0830185610acb565b826140a08301529998505050505050505050565b5f60208284031215610be7575f5ffd5b8151801515811461079b575f5ffd5b634e487b7160e01b5f52601160045260245ffd5b5f60018201610c1b57610c1b610bf6565b5060010190565b818103818111156108ae576108ae610bf6565b634e487b7160e01b5f52602160045260245ffd5b60018060a01b0386168152846020820152608060408201525f610c70608083018587610a19565b905060028310610c8e57634e487b7160e01b5f52602160045260245ffd5b8260608301529695505050505050565b5f8183825b610100811015610cea578151835f5b6002811015610cd1578251825260209283019290910190600101610cb2565b5050506040929092019160209190910190600101610ca3565b5050506140008201905092915050565b634e487b7160e01b5f52603260045260245ffd5b5f5f8335601e19843603018112610d23575f5ffd5b83018035915067ffffffffffffffff821115610d3d575f5ffd5b602001915036819003821315610812575f5ffd5b818382375f910190815291905056fea26469706673582212208c7942ac36e24a8c29c25b95531c21cf2e241b3394afc3ca0b6aded0bc7cb97c64736f6c634300081f0033","sourceMap":"1688:9904:4:-:0;;;3631:125;;;;;;;;;;;;;;;;;;;;;;;;;;;;:::i;:::-;-1:-1:-1;;;;;3676:19:4;;3668:59;;;;-1:-1:-1;;;3668:59:4;;511:2:58;3668:59:4;;;493:21:58;550:2;530:18;;;523:30;589:29;569:18;;;562:57;636:18;;3668:59:4;;;;;;;;-1:-1:-1;;;;;3737:12:4;;;1688:9904;;14:290:58;84:6;137:2;125:9;116:7;112:23;108:32;105:52;;;153:1;150;143:12;105:52;179:16;;-1:-1:-1;;;;;224:31:58;;214:42;;204:70;;270:1;267;260:12;204:70;293:5;14:290;-1:-1:-1;;;14:290:58:o;309:351::-;1688:9904:4;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;","linkReferences":{}},"deployedBytecode":{"object":"0x608060405234801561000f575f5ffd5b506004361061009b575f3560e01c80635f384225116100635780635f3842251461013657806366a47bfb146101495780636a685e3a1461015c5780636ed10fbb14610165578063cd0fb1b31461016c575f5ffd5b8063158ef93e1461009f578063186f0354146100c1578063392e53cd146101005780633b6631951461010b5780633cbf389314610120575b5f5ffd5b6001546100ac9060ff1681565b60405190151581526020015b60405180910390f35b6100e87f000000000000000000000000000000000000000000000000000000000000000081565b6040516001600160a01b0390911681526020016100b8565b60015460ff166100ac565b61011e6101193660046107a2565b61017f565b005b6101285f5481565b6040519081526020016100b8565b610128610144366004610829565b610277565b6100ac6101573660046108c5565b610334565b61012860025481565b5f54610128565b6100ac61017a366004610967565b6103a7565b336001600160a01b037f000000000000000000000000000000000000000000000000000000000000000016146101c85760405163d7fed6bd60e01b815260040160405180910390fd5b60015460ff16156101eb5760405162dc149f60e41b815260040160405180910390fd5b8061023c5760405162461bcd60e51b815260206004820152601760248201527f4c616d706f72744d6f64756c653a207a65726f20504b48000000000000000000604482015260640160405180910390fd5b5f8181556001805460ff19168117905560405182917ff83bf9e0a6257495710d3a8dd8849575a48f412e4e06b158ab01360d30dc290291a250565b5f5f7f00000000000000000000000000000000000000000000000000000000000000006001600160a01b031663d8d11f7889898989895f5f5f5f5f6002546040518c63ffffffff1660e01b81526004016102db9b9a99989796959493929190610a41565b602060405180830381865afa1580156102f6573d5f5f3e3d5ffd5b505050506040513d601f19601f8201168201806040525081019061031a9190610ab4565b90506103288184304661066b565b98975050505050505050565b60405163cd0fb1b360e01b81525f90309063cd0fb1b390610367908b908b908b908b9088908c908c908c90600401610af6565b6020604051808303815f875af1158015610383573d5f5f3e3d5ffd5b505050506040513d601f19601f820116820180604052508101906103289190610bd7565b6001545f9060ff166103cc576040516321c4e35760e21b815260040160405180910390fd5b6040805161200081019091525f9061042b908561010084835b82821015610422576040805180820182529080840286019060029083908390808284375f92019190915250505081526001909101906020016103e5565b505050506106bc565b90505f54811461044e5760405163145a1fdd60e31b815260040160405180910390fd5b600254604051631b1a23ef60e31b81525f916001600160a01b037f0000000000000000000000000000000000000000000000000000000000000000169163d8d11f78916104b1918f918f918f918f918f918a918291829182918291600401610a41565b602060405180830381865afa1580156104cc573d5f5f3e3d5ffd5b505050506040513d601f19601f820116820180604052508101906104f09190610ab4565b90505f6104ff8286304661066b565b905061050c8188886106eb565b61052957604051630dbc2bdf60e11b815260040160405180910390fd5b5f805486825560028054919261053e83610c0a565b9091555050604051869082907f7abd04341ca4fa109bdfe5f4350efb88488e5a9253db95d3b19d1ff6592b361e905f90a385837ffd39c0345819c8cb423e22447cb682f42d870deabfd1b5c5981bdd0b7aac2fc960016002546105a19190610c22565b60405190815260200160405180910390a37f00000000000000000000000000000000000000000000000000000000000000006001600160a01b031663468721a78e8e8e8e8e60ff1660018111156105fa576105fa610c35565b6040518663ffffffff1660e01b815260040161061a959493929190610c49565b6020604051808303815f875af1158015610636573d5f5f3e3d5ffd5b505050506040513d601f19601f8201168201806040525081019061065a9190610bd7565b9d9c50505050505050505050505050565b60408051602080820196909652808201949094526bffffffffffffffffffffffff19606093841b16928401929092526074808401919091528151808403909101815260949092019052805191012090565b5f816040516020016106ce9190610c9e565b604051602081830303815290604052805190602001209050919050565b5f5f5b610100811015610795575f5f8260ff036001901b87161161070f575f610712565b60015b60ff1690508382610100811061072a5761072a610cfa565b60400201816002811061073f5761073f610cfa565b60200201358583610100811061075757610757610cfa565b6020028101906107679190610d0e565b604051610775929190610d51565b60405180910390201461078c575f9250505061079b565b506001016106ee565b50600190505b9392505050565b5f602082840312156107b2575f5ffd5b5035919050565b80356001600160a01b03811681146107cf575f5ffd5b919050565b5f5f83601f8401126107e4575f5ffd5b50813567ffffffffffffffff8111156107fb575f5ffd5b602083019150836020828501011115610812575f5ffd5b9250929050565b803560ff811681146107cf575f5ffd5b5f5f5f5f5f5f60a0878903121561083e575f5ffd5b610847876107b9565b955060208701359450604087013567ffffffffffffffff811115610869575f5ffd5b61087589828a016107d4565b9095509350610888905060608801610819565b95989497509295919493608090920135925050565b8061200081018310156108ae575f5ffd5b92915050565b8061400081018310156108ae575f5ffd5b5f5f5f5f5f5f5f6140a0888a0312156108dc575f5ffd5b6108e5886107b9565b965060208801359550604088013567ffffffffffffffff811115610907575f5ffd5b6109138a828b016107d4565b909650945050606088013567ffffffffffffffff811115610932575f5ffd5b61093e8a828b0161089d565b93505061094e8960808a016108b4565b9699959850939692959194919350506140809091013590565b5f5f5f5f5f5f5f5f6140c0898b03121561097f575f5ffd5b610988896107b9565b975060208901359650604089013567ffffffffffffffff8111156109aa575f5ffd5b6109b68b828c016107d4565b90975095506109c9905060608a01610819565b9350608089013567ffffffffffffffff8111156109e4575f5ffd5b6109f08b828c0161089d565b935050610a008a60a08b016108b4565b979a96995094979396929591945091926140a001359150565b81835281816020850137505f828201602090810191909152601f909101601f19169091010190565b60018060a01b038c1681528a602082015261014060408201525f610a6a61014083018b8d610a19565b60ff99909916606083015250608081019690965260a086019490945260c08501929092526001600160a01b0390811660e08501521661010083015261012090910152949350505050565b5f60208284031215610ac4575f5ffd5b5051919050565b805f5b610100811015610af05760408285376040938401939190910190600101610ace565b50505050565b60018060a01b03891681528760208201526140c060408201525f610b1f6140c08301888a610a19565b60ff871660608401528281036080840152806120008101875f36829003601e19015b610100821015610bad5785840385528235818112610b5d575f5ffd5b8b0160208101903567ffffffffffffffff811115610b79575f5ffd5b803603821315610b87575f5ffd5b610b92868284610a19565b95505050602083019250602085019450600182019150610b41565b505050809350505050610bc360a0830185610acb565b826140a08301529998505050505050505050565b5f60208284031215610be7575f5ffd5b8151801515811461079b575f5ffd5b634e487b7160e01b5f52601160045260245ffd5b5f60018201610c1b57610c1b610bf6565b5060010190565b818103818111156108ae576108ae610bf6565b634e487b7160e01b5f52602160045260245ffd5b60018060a01b0386168152846020820152608060408201525f610c70608083018587610a19565b905060028310610c8e57634e487b7160e01b5f52602160045260245ffd5b8260608301529695505050505050565b5f8183825b610100811015610cea578151835f5b6002811015610cd1578251825260209283019290910190600101610cb2565b5050506040929092019160209190910190600101610ca3565b5050506140008201905092915050565b634e487b7160e01b5f52603260045260245ffd5b5f5f8335601e19843603018112610d23575f5ffd5b83018035915067ffffffffffffffff821115610d3d575f5ffd5b602001915036819003821315610812575f5ffd5b818382375f910190815291905056fea26469706673582212208c7942ac36e24a8c29c25b95531c21cf2e241b3394afc3ca0b6aded0bc7cb97c64736f6c634300081f0033","sourceMap":"1688:9904:4:-:0;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;2357:23;;;;;;;;;;;;179:14:58;;172:22;154:41;;142:2;127:18;2357:23:4;;;;;;;;2226:29;;;;;;;;-1:-1:-1;;;;;370:32:58;;;352:51;;340:2;325:18;2226:29:4;206:203:58;11501:89:4;11572:11;;;;11501:89;;4262:282;;;;;;:::i;:::-;;:::i;:::-;;2297:18;;;;;;;;;791:25:58;;;779:2;764:18;2297::4;645:177:58;10710:597:4;;;;;;:::i;:::-;;:::i;9775:429::-;;;;;;:::i;:::-;;:::i;2422:27::-;;;;;;11363:77;11404:7;11430:3;11363:77;;5045:4380;;;;;;:::i;:::-;;:::i;4262:282::-;3015:10;-1:-1:-1;;;;;3029:4:4;3015:18;;3011:41;;3042:10;;-1:-1:-1;;;3042:10:4;;;;;;;;;;;3011:41;4328:11:::1;::::0;::::1;;4324:44;;;4348:20;;-1:-1:-1::0;;;4348:20:4::1;;;;;;;;;;;4324:44;4386:10:::0;4378:60:::1;;;::::0;-1:-1:-1;;;4378:60:4;;5444:2:58;4378:60:4::1;::::0;::::1;5426:21:58::0;5483:2;5463:18;;;5456:30;5522:25;5502:18;;;5495:53;5565:18;;4378:60:4::1;;;;;;;;4448:3;:16:::0;;;4488:4:::1;4474:18:::0;;-1:-1:-1;;4474:18:4::1;::::0;::::1;::::0;;4507:30:::1;::::0;4454:10;;4507:30:::1;::::0;::::1;4262:282:::0;:::o;10710:597::-;10889:9;10910:18;10937:4;-1:-1:-1;;;;;10931:30:4;;10975:2;10991:5;11010:4;;11028:9;11051:1;11054;11057;11080;11104;11120:12;;10931:211;;;;;;;;;;;;;;;;;;;;;;;;;:::i;:::-;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;:::i;:::-;10910:232;;11157:143;11205:10;11229:7;11258:4;11277:13;11157:34;:143::i;:::-;11153:147;10710:597;-1:-1:-1;;;;;;;;10710:597:4:o;9775:429::-;10019:178;;-1:-1:-1;;;10019:178:4;;9988:12;;10019:4;;:20;;:178;;10053:2;;10069:5;;10088:4;;;;9988:12;;10139:3;;10156:10;;10180:7;;10019:178;;;:::i;:::-;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;:::i;5045:4380::-;5323:11;;5294:12;;5323:11;;5318:41;;5343:16;;-1:-1:-1;;;5343:16:4;;;;;;;;;;;5318:41;5857:33;;;;;;;;;5837:17;;5857:33;;5879:10;5857:33;5837:17;5857:33;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;-1:-1:-1;;;5857:33:4;;;;;;;;;;;;;;;;:21;:33::i;:::-;5837:53;;5917:3;;5904:9;:16;5900:72;;5943:18;;-1:-1:-1;;;5943:18:4;;;;;;;;;;;5900:72;6880:12;;6529:373;;-1:-1:-1;;;6529:373:4;;6508:18;;-1:-1:-1;;;;;6535:4:4;6529:30;;;;:373;;6573:2;;6589:5;;6608:4;;;;6626:9;;6508:18;;;;;;;;;;6529:373;;;:::i;:::-;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;:::i;:::-;6508:394;;7377:9;7389:211;7437:10;7461:7;7490:4;7544:13;7389:34;:211::i;:::-;7377:223;;8062:42;8085:1;8088:3;8093:10;8062:22;:42::i;:::-;8057:106;;8127:25;;-1:-1:-1;;;8127:25:4;;;;;;;;;;;8057:106;8633:14;8650:3;;8663:13;;;8686:12;:14;;8650:3;;8686:14;;;:::i;:::-;;;;-1:-1:-1;;8716:34:4;;8742:7;;8734:6;;8716:34;;;;;8793:7;8781:10;8765:54;8817:1;8802:12;;:16;;;;:::i;:::-;8765:54;;791:25:58;;;779:2;764:18;8765:54:4;;;;;;;9284:4;-1:-1:-1;;;;;9278:37:4;;9329:2;9345:5;9364:4;;9398:9;9382:26;;;;;;;;;;:::i;:::-;9278:140;;;;;;;;;;;;;;;;;;;:::i;:::-;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;:::i;:::-;9268:150;5045:4380;-1:-1:-1;;;;;;;;;;;;;5045:4380:4:o;4340:331:3:-;4550:112;;;;;;;10945:19:58;;;;10980:12;;;10973:28;;;;-1:-1:-1;;11039:2:58;11035:15;;;11031:53;11017:12;;;11010:75;;;;11101:12;;;;11094:28;;;;4550:112:3;;;;;;;;;;11138:13:58;;;;4550:112:3;;4540:123;;;;;;4340:331::o;3711:166::-;3802:11;3859:9;3842:27;;;;;;;;:::i;:::-;;;;;;;;;;;;;3832:38;;;;;;3825:45;;3711:166;;;:::o;944:647::-;1087:10;1138:9;1133:417;1153:3;1149:1;:7;1133:417;;;1314:11;1357:1;1350;1344:3;:7;1338:1;:14;;1330:4;:23;1329:29;1328:39;;1366:1;1328:39;;;1362:1;1328:39;1314:53;;;;1470:3;1474:1;1470:6;;;;;;;:::i;:::-;;;;1477:3;1470:11;;;;;;;:::i;:::-;;;;;1459:3;1463:1;1459:6;;;;;;;:::i;:::-;;;;;;;;;;:::i;:::-;1449:17;;;;;;;:::i;:::-;;;;;;;;:32;1445:91;;1512:5;1505:12;;;;;;1445:91;-1:-1:-1;1158:3:3;;1133:417;;;;1570:4;1563:11;;944:647;;;;;;:::o;414:226:58:-;473:6;526:2;514:9;505:7;501:23;497:32;494:52;;;542:1;539;532:12;494:52;-1:-1:-1;587:23:58;;414:226;-1:-1:-1;414:226:58:o;827:173::-;895:20;;-1:-1:-1;;;;;944:31:58;;934:42;;924:70;;990:1;987;980:12;924:70;827:173;;;:::o;1005:347::-;1056:8;1066:6;1120:3;1113:4;1105:6;1101:17;1097:27;1087:55;;1138:1;1135;1128:12;1087:55;-1:-1:-1;1161:20:58;;1204:18;1193:30;;1190:50;;;1236:1;1233;1226:12;1190:50;1273:4;1265:6;1261:17;1249:29;;1325:3;1318:4;1309:6;1301;1297:19;1293:30;1290:39;1287:59;;;1342:1;1339;1332:12;1287:59;1005:347;;;;;:::o;1357:156::-;1423:20;;1483:4;1472:16;;1462:27;;1452:55;;1503:1;1500;1493:12;1518:789;1622:6;1630;1638;1646;1654;1662;1715:3;1703:9;1694:7;1690:23;1686:33;1683:53;;;1732:1;1729;1722:12;1683:53;1755:29;1774:9;1755:29;:::i;:::-;1745:39;-1:-1:-1;1853:2:58;1838:18;;1825:32;;-1:-1:-1;1932:2:58;1917:18;;1904:32;1959:18;1948:30;;1945:50;;;1991:1;1988;1981:12;1945:50;2030:58;2080:7;2071:6;2060:9;2056:22;2030:58;:::i;:::-;2107:8;;-1:-1:-1;2004:84:58;-1:-1:-1;2161:36:58;;-1:-1:-1;2193:2:58;2178:18;;2161:36;:::i;:::-;1518:789;;;;-1:-1:-1;1518:789:58;;;;;2270:3;2255:19;;;2242:33;;-1:-1:-1;;1518:789:58:o;2494:168::-;2595:6;2628:4;2616:17;;2613:26;-1:-1:-1;2610:46:58;;;2652:1;2649;2642:12;2610:46;2494:168;;;;:::o;2667:177::-;2776:6;2809:5;2797:18;;2794:27;-1:-1:-1;2791:47:58;;;2834:1;2831;2824:12;2849:1156;3054:6;3062;3070;3078;3086;3094;3102;3155:5;3143:9;3134:7;3130:23;3126:35;3123:55;;;3174:1;3171;3164:12;3123:55;3197:29;3216:9;3197:29;:::i;:::-;3187:39;-1:-1:-1;3295:2:58;3280:18;;3267:32;;-1:-1:-1;3374:2:58;3359:18;;3346:32;3401:18;3390:30;;3387:50;;;3433:1;3430;3423:12;3387:50;3472:58;3522:7;3513:6;3502:9;3498:22;3472:58;:::i;:::-;3549:8;;-1:-1:-1;3446:84:58;-1:-1:-1;;3637:2:58;3622:18;;3609:32;3666:18;3653:32;;3650:52;;;3698:1;3695;3688:12;3650:52;3721:75;3788:7;3777:8;3766:9;3762:24;3721:75;:::i;:::-;3711:85;;;3815:78;3885:7;3879:3;3868:9;3864:19;3815:78;:::i;:::-;2849:1156;;;;-1:-1:-1;2849:1156:58;;;;;;;;-1:-1:-1;;3966:5:58;3951:21;;;3938:35;;2849:1156::o;4010:1227::-;4222:6;4230;4238;4246;4254;4262;4270;4278;4331:5;4319:9;4310:7;4306:23;4302:35;4299:55;;;4350:1;4347;4340:12;4299:55;4373:29;4392:9;4373:29;:::i;:::-;4363:39;-1:-1:-1;4471:2:58;4456:18;;4443:32;;-1:-1:-1;4550:2:58;4535:18;;4522:32;4577:18;4566:30;;4563:50;;;4609:1;4606;4599:12;4563:50;4648:58;4698:7;4689:6;4678:9;4674:22;4648:58;:::i;:::-;4725:8;;-1:-1:-1;4622:84:58;-1:-1:-1;4779:36:58;;-1:-1:-1;4811:2:58;4796:18;;4779:36;:::i;:::-;4769:46;;4868:3;4857:9;4853:19;4840:33;4898:18;4888:8;4885:32;4882:52;;;4930:1;4927;4920:12;4882:52;4953:75;5020:7;5009:8;4998:9;4994:24;4953:75;:::i;:::-;4943:85;;;5047:78;5117:7;5111:3;5100:9;5096:19;5047:78;:::i;:::-;4010:1227;;;;-1:-1:-1;4010:1227:58;;;;;;;;-1:-1:-1;5037:88:58;;5198:5;5183:21;5170:35;;-1:-1:-1;4010:1227:58:o;5594:266::-;5682:6;5677:3;5670:19;5734:6;5727:5;5720:4;5715:3;5711:14;5698:43;-1:-1:-1;5786:1:58;5761:16;;;5779:4;5757:27;;;5750:38;;;;5842:2;5821:15;;;-1:-1:-1;;5817:29:58;5808:39;;;5804:50;;5594:266::o;5865:1010::-;6332:1;6328;6323:3;6319:11;6315:19;6307:6;6303:32;6292:9;6285:51;6372:6;6367:2;6356:9;6352:18;6345:34;6415:3;6410:2;6399:9;6395:18;6388:31;6266:4;6436:62;6493:3;6482:9;6478:19;6470:6;6462;6436:62;:::i;:::-;6546:4;6534:17;;;;6529:2;6514:18;;6507:45;-1:-1:-1;6583:3:58;6568:19;;6561:35;;;;6627:3;6612:19;;6605:35;;;;6671:3;6656:19;;6649:35;;;;-1:-1:-1;;;;;6721:32:58;;;6715:3;6700:19;;6693:61;6791:32;6785:3;6770:19;;6763:61;6855:3;6840:19;;;6833:36;6428:70;5865:1010;-1:-1:-1;;;;5865:1010:58:o;6880:184::-;6950:6;7003:2;6991:9;6982:7;6978:23;6974:32;6971:52;;;7019:1;7016;7009:12;6971:52;-1:-1:-1;7042:16:58;;6880:184;-1:-1:-1;6880:184:58:o;7069:334::-;7186:5;7209:1;7219:178;7233:6;7230:1;7227:13;7219:178;;;7308:4;7300:6;7295:3;7282:31;7342:4;7333:14;;;;7370:17;;;;;7255:1;7248:9;7219:178;;;7223:3;;7069:334;;:::o;7408:1845::-;7940:1;7936;7931:3;7927:11;7923:19;7915:6;7911:32;7900:9;7893:51;7980:6;7975:2;7964:9;7960:18;7953:34;8023:5;8018:2;8007:9;8003:18;7996:33;7874:4;8052:64;8109:5;8098:9;8094:21;8086:6;8078;8052:64;:::i;:::-;8164:4;8152:17;;8147:2;8132:18;;8125:45;8207:22;;;8201:3;8186:19;;8179:51;8211:6;8313:4;8301:17;;8341:6;-1:-1:-1;8393:14:58;8389:27;;;-1:-1:-1;;8385:41:58;8435:657;8449:6;8446:1;8443:13;8435:657;;;8522:6;8514;8510:19;8505:3;8498:32;8582:6;8569:20;8636:2;8616:18;8612:27;8602:55;;8653:1;8650;8643:12;8602:55;8683:31;;8799:2;8788:14;;;8741:19;8829:18;8818:30;;8815:50;;;8861:1;8858;8851:12;8815:50;8914:6;8898:14;8894:27;8885:7;8881:41;8878:61;;;8935:1;8932;8925:12;8878:61;8962:50;9005:6;8997;8988:7;8962:50;:::i;:::-;8952:60;;;;9047:2;9039:6;9035:15;9025:25;;9079:2;9074:3;9070:12;9063:19;;8471:1;8468;8464:9;8459:14;;8435:657;;;8439:3;;;9109:6;9101:14;;;;;9124:77;9196:3;9185:9;9181:19;9173:6;9124:77;:::i;:::-;9240:6;9232:5;9221:9;9217:21;9210:37;7408:1845;;;;;;;;;;;:::o;9258:277::-;9325:6;9378:2;9366:9;9357:7;9353:23;9349:32;9346:52;;;9394:1;9391;9384:12;9346:52;9426:9;9420:16;9479:5;9472:13;9465:21;9458:5;9455:32;9445:60;;9501:1;9498;9491:12;9540:127;9601:10;9596:3;9592:20;9589:1;9582:31;9632:4;9629:1;9622:15;9656:4;9653:1;9646:15;9672:135;9711:3;9732:17;;;9729:43;;9752:18;;:::i;:::-;-1:-1:-1;9799:1:58;9788:13;;9672:135::o;9812:128::-;9879:9;;;9900:11;;;9897:37;;;9914:18;;:::i;9945:127::-;10006:10;10001:3;9997:20;9994:1;9987:31;10037:4;10034:1;10027:15;10061:4;10058:1;10051:15;10077:650;10359:1;10355;10350:3;10346:11;10342:19;10334:6;10330:32;10319:9;10312:51;10399:6;10394:2;10383:9;10379:18;10372:34;10442:3;10437:2;10426:9;10422:18;10415:31;10293:4;10463:62;10520:3;10509:9;10505:19;10497:6;10489;10463:62;:::i;:::-;10455:70;;10555:1;10547:6;10544:13;10534:144;;10600:10;10595:3;10591:20;10588:1;10581:31;10635:4;10632:1;10625:15;10663:4;10660:1;10653:15;10534:144;10714:6;10709:2;10698:9;10694:18;10687:34;10077:650;;;;;;;;:::o;11162:866::-;11369:3;11400;11447:6;11369:3;11481:510;11495:6;11492:1;11489:13;11481:510;;;11554:13;;11593:5;11680:1;11694:209;11710:4;11705:3;11702:13;11694:209;;;11783:15;;11769:30;;11836:4;11870:19;;;;11825:16;;;;11734:1;11725:11;11694:209;;;-1:-1:-1;;;11936:4:58;11925:16;;;;;11976:4;11964:17;;;;;11517:1;11510:9;11481:510;;;11485:3;;;12016:5;12011:3;12007:15;12000:22;;11162:866;;;;:::o;12033:127::-;12094:10;12089:3;12085:20;12082:1;12075:31;12125:4;12122:1;12115:15;12149:4;12146:1;12139:15;12165:521;12242:4;12248:6;12308:11;12295:25;12402:2;12398:7;12387:8;12371:14;12367:29;12363:43;12343:18;12339:68;12329:96;;12421:1;12418;12411:12;12329:96;12448:33;;12500:20;;;-1:-1:-1;12543:18:58;12532:30;;12529:50;;;12575:1;12572;12565:12;12529:50;12608:4;12596:17;;-1:-1:-1;12639:14:58;12635:27;;;12625:38;;12622:58;;;12676:1;12673;12666:12;12691:271;12874:6;12866;12861:3;12848:33;12830:3;12900:16;;12925:13;;;12900:16;12691:271;-1:-1:-1;12691:271:58:o","linkReferences":{},"immutableReferences":{"1141":[{"start":198,"length":32},{"start":394,"length":32},{"start":635,"length":32},{"start":1130,"length":32},{"start":1460,"length":32}]}},"methodIdentifiers":{"computeMessageHash(address,uint256,bytes,uint8,bytes32)":"5f384225","exec(address,uint256,bytes,bytes[256],bytes32[2][256],bytes32)":"66a47bfb","execWithLamport(address,uint256,bytes,uint8,bytes[256],bytes32[2][256],bytes32)":"cd0fb1b3","getPKH()":"6ed10fbb","init(bytes32)":"3b663195","initialized()":"158ef93e","isInitialized()":"392e53cd","lamportNonce()":"6a685e3a","pkh()":"3cbf3893","safe()":"186f0354"},"rawMetadata":"{\"compiler\":{\"version\":\"0.8.31+commit.fd3a2265\"},\"language\":\"Solidity\",\"output\":{\"abi\":[{\"inputs\":[{\"internalType\":\"address\",\"name\":\"_safe\",\"type\":\"address\"}],\"stateMutability\":\"nonpayable\",\"type\":\"constructor\"},{\"inputs\":[],\"name\":\"AlreadyInitialized\",\"type\":\"error\"},{\"inputs\":[],\"name\":\"InvalidLamportSignature\",\"type\":\"error\"},{\"inputs\":[],\"name\":\"InvalidPublicKey\",\"type\":\"error\"},{\"inputs\":[],\"name\":\"NotInitialized\",\"type\":\"error\"},{\"inputs\":[],\"name\":\"OnlySafe\",\"type\":\"error\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":true,\"internalType\":\"bytes32\",\"name\":\"safeTxHash\",\"type\":\"bytes32\"},{\"indexed\":true,\"internalType\":\"bytes32\",\"name\":\"nextPkh\",\"type\":\"bytes32\"},{\"indexed\":false,\"internalType\":\"uint256\",\"name\":\"nonce\",\"type\":\"uint256\"}],\"name\":\"LamportExecuted\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":true,\"internalType\":\"bytes32\",\"name\":\"initialPkh\",\"type\":\"bytes32\"}],\"name\":\"LamportInitialized\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":true,\"internalType\":\"bytes32\",\"name\":\"oldPkh\",\"type\":\"bytes32\"},{\"indexed\":true,\"internalType\":\"bytes32\",\"name\":\"newPkh\",\"type\":\"bytes32\"}],\"name\":\"LamportKeyRotated\",\"type\":\"event\"},{\"inputs\":[{\"internalType\":\"address\",\"name\":\"to\",\"type\":\"address\"},{\"internalType\":\"uint256\",\"name\":\"value\",\"type\":\"uint256\"},{\"internalType\":\"bytes\",\"name\":\"data\",\"type\":\"bytes\"},{\"internalType\":\"uint8\",\"name\":\"operation\",\"type\":\"uint8\"},{\"internalType\":\"bytes32\",\"name\":\"nextPKH\",\"type\":\"bytes32\"}],\"name\":\"computeMessageHash\",\"outputs\":[{\"internalType\":\"uint256\",\"name\":\"m\",\"type\":\"uint256\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"address\",\"name\":\"to\",\"type\":\"address\"},{\"internalType\":\"uint256\",\"name\":\"value\",\"type\":\"uint256\"},{\"internalType\":\"bytes\",\"name\":\"data\",\"type\":\"bytes\"},{\"internalType\":\"bytes[256]\",\"name\":\"sig\",\"type\":\"bytes[256]\"},{\"internalType\":\"bytes32[2][256]\",\"name\":\"currentPub\",\"type\":\"bytes32[2][256]\"},{\"internalType\":\"bytes32\",\"name\":\"nextPKH\",\"type\":\"bytes32\"}],\"name\":\"exec\",\"outputs\":[{\"internalType\":\"bool\",\"name\":\"success\",\"type\":\"bool\"}],\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"address\",\"name\":\"to\",\"type\":\"address\"},{\"internalType\":\"uint256\",\"name\":\"value\",\"type\":\"uint256\"},{\"internalType\":\"bytes\",\"name\":\"data\",\"type\":\"bytes\"},{\"internalType\":\"uint8\",\"name\":\"operation\",\"type\":\"uint8\"},{\"internalType\":\"bytes[256]\",\"name\":\"sig\",\"type\":\"bytes[256]\"},{\"internalType\":\"bytes32[2][256]\",\"name\":\"currentPub\",\"type\":\"bytes32[2][256]\"},{\"internalType\":\"bytes32\",\"name\":\"nextPKH\",\"type\":\"bytes32\"}],\"name\":\"execWithLamport\",\"outputs\":[{\"internalType\":\"bool\",\"name\":\"success\",\"type\":\"bool\"}],\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"getPKH\",\"outputs\":[{\"internalType\":\"bytes32\",\"name\":\"\",\"type\":\"bytes32\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"bytes32\",\"name\":\"initialPkh\",\"type\":\"bytes32\"}],\"name\":\"init\",\"outputs\":[],\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"initialized\",\"outputs\":[{\"internalType\":\"bool\",\"name\":\"\",\"type\":\"bool\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"isInitialized\",\"outputs\":[{\"internalType\":\"bool\",\"name\":\"\",\"type\":\"bool\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"lamportNonce\",\"outputs\":[{\"internalType\":\"uint256\",\"name\":\"\",\"type\":\"uint256\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"pkh\",\"outputs\":[{\"internalType\":\"bytes32\",\"name\":\"\",\"type\":\"bytes32\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"safe\",\"outputs\":[{\"internalType\":\"address\",\"name\":\"\",\"type\":\"address\"}],\"stateMutability\":\"view\",\"type\":\"function\"}],\"devdoc\":{\"author\":\"Lux Network Team\",\"details\":\"Threshold lives OFF-CHAIN (T-Chain MPC network jointly controls ONE Lamport key).      On-chain verifies a normal Lamport signature - no changes to verification logic. SECURITY MODEL: - Threshold property (t-of-n) enforced by T-Chain MPC network - On-chain sees ONE standard Lamport signature - Works on ANY EVM chain (no precompiles needed) - Domain separation prevents replay attacks ATTACK MITIGATIONS: - Canonical digest: safeTxHash computed ON-CHAIN (never accept from coordinator) - Domain separation: address(this) + block.chainid in message - One-time keys: pkh = nextPKH rotation after each signature - Init guard: only Safe can initialize See: LP-4105 (Lamport OTS for Lux Safe)\",\"kind\":\"dev\",\"methods\":{\"computeMessageHash(address,uint256,bytes,uint8,bytes32)\":{\"params\":{\"data\":\"Call data\",\"nextPKH\":\"Next public key hash\",\"operation\":\"Operation type (0=Call, 1=DelegateCall)\",\"to\":\"Destination address\",\"value\":\"ETH value\"},\"returns\":{\"m\":\"The message hash to sign (256 bits)\"}},\"constructor\":{\"params\":{\"_safe\":\"The Safe address this module is attached to\"}},\"exec(address,uint256,bytes,bytes[256],bytes32[2][256],bytes32)\":{\"params\":{\"currentPub\":\"Current public key\",\"data\":\"Call data\",\"nextPKH\":\"Next public key hash\",\"sig\":\"Lamport signature\",\"to\":\"Destination address\",\"value\":\"ETH value\"},\"returns\":{\"success\":\"True if execution succeeded\"}},\"execWithLamport(address,uint256,bytes,uint8,bytes[256],bytes32[2][256],bytes32)\":{\"params\":{\"currentPub\":\"Current public key (bytes32[2][256])\",\"data\":\"Call data\",\"nextPKH\":\"Hash of next public key (for rotation)\",\"operation\":\"0 = Call, 1 = DelegateCall\",\"sig\":\"Lamport signature (bytes[256])\",\"to\":\"Destination address\",\"value\":\"ETH value in wei\"},\"returns\":{\"success\":\"True if execution succeeded\"}},\"init(bytes32)\":{\"params\":{\"initialPkh\":\"Hash of initial Lamport public key\"}}},\"title\":\"LamportModule\",\"version\":1},\"userdoc\":{\"errors\":{\"AlreadyInitialized()\":[{\"notice\":\"Error when module is already initialized\"}],\"InvalidLamportSignature()\":[{\"notice\":\"Error when Lamport signature is invalid\"}],\"InvalidPublicKey()\":[{\"notice\":\"Error when public key doesn't match stored hash\"}],\"NotInitialized()\":[{\"notice\":\"Error when module is not initialized\"}],\"OnlySafe()\":[{\"notice\":\"Error when caller is not the Safe\"}]},\"events\":{\"LamportExecuted(bytes32,bytes32,uint256)\":{\"notice\":\"Emitted when a transaction is executed with Lamport signature\"},\"LamportInitialized(bytes32)\":{\"notice\":\"Emitted when module is initialized\"},\"LamportKeyRotated(bytes32,bytes32)\":{\"notice\":\"Emitted when Lamport key is rotated\"}},\"kind\":\"user\",\"methods\":{\"computeMessageHash(address,uint256,bytes,uint8,bytes32)\":{\"notice\":\"Compute the message hash that should be signed\"},\"constructor\":{\"notice\":\"Constructor\"},\"exec(address,uint256,bytes,bytes[256],bytes32[2][256],bytes32)\":{\"notice\":\"Execute with Call operation (convenience function)\"},\"execWithLamport(address,uint256,bytes,uint8,bytes[256],bytes32[2][256],bytes32)\":{\"notice\":\"Execute Safe transaction with Lamport signature\"},\"getPKH()\":{\"notice\":\"Get current PKH (alias for pkh())\"},\"init(bytes32)\":{\"notice\":\"Initialize with first Lamport public key hash\"},\"initialized()\":{\"notice\":\"Check if module is initialized\"},\"isInitialized()\":{\"notice\":\"Check if module is initialized (alias)\"},\"lamportNonce()\":{\"notice\":\"Get current Lamport nonce\"},\"pkh()\":{\"notice\":\"Get current public key hash\"},\"safe()\":{\"notice\":\"Get the Safe address this module is attached to\"}},\"notice\":\"Safe module for threshold Lamport signature execution\",\"version\":1}},\"settings\":{\"compilationTarget\":{\"LamportModule.sol\":\"LamportModule\"},\"evmVersion\":\"prague\",\"libraries\":{},\"metadata\":{\"bytecodeHash\":\"ipfs\"},\"optimizer\":{\"enabled\":true,\"runs\":200},\"remappings\":[\":forge-std/=lib/forge-std/src/\"]},\"sources\":{\"ILamportModule.sol\":{\"keccak256\":\"0xc868a9587dac1ce2b9402db6b17aa24fdbfe0f52dd6a568360106c301ca84940\",\"license\":\"BSD-3-Clause\",\"urls\":[\"bzz-raw://f05ecacf6b79dce6bf313ad9c5fb618f6a54723472071ef9b2c70b56f546677a\",\"dweb:/ipfs/QmYs7CXpW9JWYjNzxQcfXrY2rewfNj6dFk6hQyRbTV857c\"]},\"LamportLib.sol\":{\"keccak256\":\"0xf71adc717c6d120f9bd14ee23ec341bc1df9d8c5f9da502b4810a91980ecf580\",\"license\":\"BSD-3-Clause\",\"urls\":[\"bzz-raw://6a1d7965d582e61f0f48583c1da23afd55f1977f2d6deb840b8f469e9d133689\",\"dweb:/ipfs/Qmdt2zsm38Mf7g3YoDinniWBgP1eooim62ND1UFkVGcHiC\"]},\"LamportModule.sol\":{\"keccak256\":\"0xd061cc08c7fb7dffb630d2be760e3bb41ba6755d3ad73bb763c3527d9ea5a1dd\",\"license\":\"BSD-3-Clause\",\"urls\":[\"bzz-raw://d015d8d54455666e732f2ab127599208781919039bdc41b45e85955899ed7468\",\"dweb:/ipfs/QmcUF5Cz36g1LH5DTZNgfGEeCBJRa3k6yVcLbLN6nnja7S\"]}},\"version\":1}","metadata":{"compiler":{"version":"0.8.31+commit.fd3a2265"},"language":"Solidity","output":{"abi":[{"inputs":[{"internalType":"address","name":"_safe","type":"address"}],"stateMutability":"nonpayable","type":"constructor"},{"inputs":[],"type":"error","name":"AlreadyInitialized"},{"inputs":[],"type":"error","name":"InvalidLamportSignature"},{"inputs":[],"type":"error","name":"InvalidPublicKey"},{"inputs":[],"type":"error","name":"NotInitialized"},{"inputs":[],"type":"error","name":"OnlySafe"},{"inputs":[{"internalType":"bytes32","name":"safeTxHash","type":"bytes32","indexed":true},{"internalType":"bytes32","name":"nextPkh","type":"bytes32","indexed":true},{"internalType":"uint256","name":"nonce","type":"uint256","indexed":false}],"type":"event","name":"LamportExecuted","anonymous":false},{"inputs":[{"internalType":"bytes32","name":"initialPkh","type":"bytes32","indexed":true}],"type":"event","name":"LamportInitialized","anonymous":false},{"inputs":[{"internalType":"bytes32","name":"oldPkh","type":"bytes32","indexed":true},{"internalType":"bytes32","name":"newPkh","type":"bytes32","indexed":true}],"type":"event","name":"LamportKeyRotated","anonymous":false},{"inputs":[{"internalType":"address","name":"to","type":"address"},{"internalType":"uint256","name":"value","type":"uint256"},{"internalType":"bytes","name":"data","type":"bytes"},{"internalType":"uint8","name":"operation","type":"uint8"},{"internalType":"bytes32","name":"nextPKH","type":"bytes32"}],"stateMutability":"view","type":"function","name":"computeMessageHash","outputs":[{"internalType":"uint256","name":"m","type":"uint256"}]},{"inputs":[{"internalType":"address","name":"to","type":"address"},{"internalType":"uint256","name":"value","type":"uint256"},{"internalType":"bytes","name":"data","type":"bytes"},{"internalType":"bytes[256]","name":"sig","type":"bytes[256]"},{"internalType":"bytes32[2][256]","name":"currentPub","type":"bytes32[2][256]"},{"internalType":"bytes32","name":"nextPKH","type":"bytes32"}],"stateMutability":"nonpayable","type":"function","name":"exec","outputs":[{"internalType":"bool","name":"success","type":"bool"}]},{"inputs":[{"internalType":"address","name":"to","type":"address"},{"internalType":"uint256","name":"value","type":"uint256"},{"internalType":"bytes","name":"data","type":"bytes"},{"internalType":"uint8","name":"operation","type":"uint8"},{"internalType":"bytes[256]","name":"sig","type":"bytes[256]"},{"internalType":"bytes32[2][256]","name":"currentPub","type":"bytes32[2][256]"},{"internalType":"bytes32","name":"nextPKH","type":"bytes32"}],"stateMutability":"nonpayable","type":"function","name":"execWithLamport","outputs":[{"internalType":"bool","name":"success","type":"bool"}]},{"inputs":[],"stateMutability":"view","type":"function","name":"getPKH","outputs":[{"internalType":"bytes32","name":"","type":"bytes32"}]},{"inputs":[{"internalType":"bytes32","name":"initialPkh","type":"bytes32"}],"stateMutability":"nonpayable","type":"function","name":"init"},{"inputs":[],"stateMutability":"view","type":"function","name":"initialized","outputs":[{"internalType":"bool","name":"","type":"bool"}]},{"inputs":[],"stateMutability":"view","type":"function","name":"isInitialized","outputs":[{"internalType":"bool","name":"","type":"bool"}]},{"inputs":[],"stateMutability":"view","type":"function","name":"lamportNonce","outputs":[{"internalType":"uint256","name":"","type":"uint256"}]},{"inputs":[],"stateMutability":"view","type":"function","name":"pkh","outputs":[{"internalType":"bytes32","name":"","type":"bytes32"}]},{"inputs":[],"stateMutability":"view","type":"function","name":"safe","outputs":[{"internalType":"address","name":"","type":"address"}]}],"devdoc":{"kind":"dev","methods":{"computeMessageHash(address,uint256,bytes,uint8,bytes32)":{"params":{"data":"Call data","nextPKH":"Next public key hash","operation":"Operation type (0=Call, 1=DelegateCall)","to":"Destination address","value":"ETH value"},"returns":{"m":"The message hash to sign (256 bits)"}},"constructor":{"params":{"_safe":"The Safe address this module is attached to"}},"exec(address,uint256,bytes,bytes[256],bytes32[2][256],bytes32)":{"params":{"currentPub":"Current public key","data":"Call data","nextPKH":"Next public key hash","sig":"Lamport signature","to":"Destination address","value":"ETH value"},"returns":{"success":"True if execution succeeded"}},"execWithLamport(address,uint256,bytes,uint8,bytes[256],bytes32[2][256],bytes32)":{"params":{"currentPub":"Current public key (bytes32[2][256])","data":"Call data","nextPKH":"Hash of next public key (for rotation)","operation":"0 = Call, 1 = DelegateCall","sig":"Lamport signature (bytes[256])","to":"Destination address","value":"ETH value in wei"},"returns":{"success":"True if execution succeeded"}},"init(bytes32)":{"params":{"initialPkh":"Hash of initial Lamport public key"}}},"version":1},"userdoc":{"kind":"user","methods":{"computeMessageHash(address,uint256,bytes,uint8,bytes32)":{"notice":"Compute the message hash that should be signed"},"constructor":{"notice":"Constructor"},"exec(address,uint256,bytes,bytes[256],bytes32[2][256],bytes32)":{"notice":"Execute with Call operation (convenience function)"},"execWithLamport(address,uint256,bytes,uint8,bytes[256],bytes32[2][256],bytes32)":{"notice":"Execute Safe transaction with Lamport signature"},"getPKH()":{"notice":"Get current PKH (alias for pkh())"},"init(bytes32)":{"notice":"Initialize with first Lamport public key hash"},"initialized()":{"notice":"Check if module is initialized"},"isInitialized()":{"notice":"Check if module is initialized (alias)"},"lamportNonce()":{"notice":"Get current Lamport nonce"},"pkh()":{"notice":"Get current public key hash"},"safe()":{"notice":"Get the Safe address this module is attached to"}},"version":1}},"settings":{"remappings":["forge-std/=lib/forge-std/src/"],"optimizer":{"enabled":true,"runs":200},"metadata":{"bytecodeHash":"ipfs"},"compilationTarget":{"LamportModule.sol":"LamportModule"},"evmVersion":"prague","libraries":{}},"sources":{"ILamportModule.sol":{"keccak256":"0xc868a9587dac1ce2b9402db6b17aa24fdbfe0f52dd6a568360106c301ca84940","urls":["bzz-raw://f05ecacf6b79dce6bf313ad9c5fb618f6a54723472071ef9b2c70b56f546677a","dweb:/ipfs/QmYs7CXpW9JWYjNzxQcfXrY2rewfNj6dFk6hQyRbTV857c"],"license":"BSD-3-Clause"},"LamportLib.sol":{"keccak256":"0xf71adc717c6d120f9bd14ee23ec341bc1df9d8c5f9da502b4810a91980ecf580","urls":["bzz-raw://6a1d7965d582e61f0f48583c1da23afd55f1977f2d6deb840b8f469e9d133689","dweb:/ipfs/Qmdt2zsm38Mf7g3YoDinniWBgP1eooim62ND1UFkVGcHiC"],"license":"BSD-3-Clause"},"LamportModule.sol":{"keccak256":"0xd061cc08c7fb7dffb630d2be760e3bb41ba6755d3ad73bb763c3527d9ea5a1dd","urls":["bzz-raw://d015d8d54455666e732f2ab127599208781919039bdc41b45e85955899ed7468","dweb:/ipfs/QmcUF5Cz36g1LH5DTZNgfGEeCBJRa3k6yVcLbLN6nnja7S"],"license":"BSD-3-Clause"}},"version":1},"id":4}