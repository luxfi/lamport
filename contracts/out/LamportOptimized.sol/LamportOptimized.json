{"abi":[{"type":"function","name":"verifyBranchless","inputs":[{"name":"bits","type":"uint256","internalType":"uint256"},{"name":"sig","type":"bytes32[256]","internalType":"bytes32[256]"},{"name":"pub","type":"bytes32[2][256]","internalType":"bytes32[2][256]"}],"outputs":[{"name":"valid","type":"bool","internalType":"bool"}],"stateMutability":"pure"},{"type":"function","name":"verifyFast","inputs":[{"name":"bits","type":"uint256","internalType":"uint256"},{"name":"sig","type":"bytes32[256]","internalType":"bytes32[256]"},{"name":"pub","type":"bytes32[2][256]","internalType":"bytes32[2][256]"}],"outputs":[{"name":"valid","type":"bool","internalType":"bool"}],"stateMutability":"pure"},{"type":"function","name":"verifyUnrolled","inputs":[{"name":"bits","type":"uint256","internalType":"uint256"},{"name":"sig","type":"bytes32[256]","internalType":"bytes32[256]"},{"name":"pub","type":"bytes32[2][256]","internalType":"bytes32[2][256]"}],"outputs":[{"name":"valid","type":"bool","internalType":"bool"}],"stateMutability":"pure"}],"bytecode":{"object":"0x6080604052348015600e575f5ffd5b506102f98061001c5f395ff3fe608060405234801561000f575f5ffd5b506004361061003f575f3560e01c80636506d2c114610043578063816cbf5d1461006a57806393d3ae501461007d575b5f5ffd5b61005661005136600461027a565b610090565b604051901515815260200160405180910390f35b61005661007836600461027a565b6100fc565b61005661008b36600461027a565b610227565b6040516001906004355f5b6101008110156100f2578060ff03600183821c16905060208202602401803590508085525060208420602082026040840201612024019150813591508181146100e8575f955050506100f2565b505060010161009b565b5050509392505050565b6040516001906004355f5b6101008110156100f2578060ff03600183821c169050602082026024018035855250602084206020820260408402016120240191508135811461014e575f955050506100f2565b5050600181018060ff03600184821c1690506020820260240180358652506020852060208202604084020161202401925082358114610192575f96505050506100f2565b505050600281018060ff03600184821c16905060208202602401803586525060208520602082026040840201612024019250823581146101d7575f96505050506100f2565b505050600381018060ff03600184821c169050602082026024018035865250602085206020820260408402016120240192508235811461021c575f96505050506100f2565b505050600401610107565b5f6040516004355f5f5b61010081101561026e576020818102602401358552808520600160ff84900386901c81169092026040840201612024013518929092179101610231565b50159695505050505050565b5f5f5f616020848603121561028d575f5ffd5b833592506120208401858111156102a2575f5ffd5b60208501925085616020860111156102b8575f5ffd5b80915050925092509256fea2646970667358221220c91da198f7b3f7aacfc24b9891edceecc777bdef135117976b30fb8f29438f0a64736f6c634300081f0033","sourceMap":"875:8490:5:-:0;;;;;;;;;;;;;;;;;;;","linkReferences":{}},"deployedBytecode":{"object":"0x608060405234801561000f575f5ffd5b506004361061003f575f3560e01c80636506d2c114610043578063816cbf5d1461006a57806393d3ae501461007d575b5f5ffd5b61005661005136600461027a565b610090565b604051901515815260200160405180910390f35b61005661007836600461027a565b6100fc565b61005661008b36600461027a565b610227565b6040516001906004355f5b6101008110156100f2578060ff03600183821c16905060208202602401803590508085525060208420602082026040840201612024019150813591508181146100e8575f955050506100f2565b505060010161009b565b5050509392505050565b6040516001906004355f5b6101008110156100f2578060ff03600183821c169050602082026024018035855250602084206020820260408402016120240191508135811461014e575f955050506100f2565b5050600181018060ff03600184821c1690506020820260240180358652506020852060208202604084020161202401925082358114610192575f96505050506100f2565b505050600281018060ff03600184821c16905060208202602401803586525060208520602082026040840201612024019250823581146101d7575f96505050506100f2565b505050600381018060ff03600184821c169050602082026024018035865250602085206020820260408402016120240192508235811461021c575f96505050506100f2565b505050600401610107565b5f6040516004355f5f5b61010081101561026e576020818102602401358552808520600160ff84900386901c81169092026040840201612024013518929092179101610231565b50159695505050505050565b5f5f5f616020848603121561028d575f5ffd5b833592506120208401858111156102a2575f5ffd5b60208501925085616020860111156102b8575f5ffd5b80915050925092509256fea2646970667358221220c91da198f7b3f7aacfc24b9891edceecc777bdef135117976b30fb8f29438f0a64736f6c634300081f0033","sourceMap":"875:8490:5:-:0;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;2572:1764;;;;;;:::i;:::-;;:::i;:::-;;;684:14:28;;677:22;659:41;;647:2;632:18;2572:1764:5;;;;;;;4739:3049;;;;;;:::i;:::-;;:::i;8225:1138::-;;;;;;:::i;:::-;;:::i;2572:1764::-;2957:4;2951:11;3127:1;;3043:4;3030:18;2716:10;3187:1133;3201:3;3198:1;3195:10;3187:1133;;;3370:1;3365:3;3361:11;3426:1;3416:7;3408:6;3404:20;3400:28;3389:39;;3575:2;3572:1;3568:10;3562:4;3558:21;3625:9;3612:23;3596:39;;3726:8;3718:6;3711:24;;3828:2;3820:6;3810:21;4014:2;4009:3;4005:12;4000:2;3997:1;3993:10;3989:29;3981:6;3977:42;3960:59;;4065:9;4052:23;4036:39;;4167:8;4161:4;4158:18;4148:158;;4209:1;4200:10;;4283:5;;;;4148:158;-1:-1:-1;;3220:1:5;3213:9;3187:1133;;;3191:3;;;2572:1764;;;;;:::o;4739:3049::-;5038:4;5032:11;5111:1;;5084:4;5071:18;4887:10;5196:2576;5221:3;5218:1;5215:10;5196:2576;;;5387:1;5382:3;5378:11;5447:1;5437:7;5429:6;5425:20;5421:28;5410:39;;5504:2;5501:1;5497:10;5491:4;5487:21;5557:9;5544:23;5536:6;5529:39;;5619:2;5611:6;5601:21;5697:2;5692:3;5688:12;5683:2;5680:1;5676:10;5672:29;5664:6;5660:42;5643:59;;5755:9;5742:23;5736:4;5733:33;5723:133;;5803:1;5794:10;;5829:5;;;;5723:133;;;5969:1;5966;5962:9;6015:1;6010:3;6006:11;6075:1;6065:7;6057:6;6053:20;6049:28;6038:39;;6132:2;6129:1;6125:10;6119:4;6115:21;6185:9;6172:23;6164:6;6157:39;;6247:2;6239:6;6229:21;6325:2;6320:3;6316:12;6311:2;6308:1;6304:10;6300:29;6292:6;6288:42;6271:59;;6383:9;6370:23;6364:4;6361:33;6351:133;;6431:1;6422:10;;6457:5;;;;;6351:133;;;;6597:1;6594;6590:9;6643:1;6638:3;6634:11;6703:1;6693:7;6685:6;6681:20;6677:28;6666:39;;6760:2;6757:1;6753:10;6747:4;6743:21;6813:9;6800:23;6792:6;6785:39;;6875:2;6867:6;6857:21;6953:2;6948:3;6944:12;6939:2;6936:1;6932:10;6928:29;6920:6;6916:42;6899:59;;7011:9;6998:23;6992:4;6989:33;6979:133;;7059:1;7050:10;;7085:5;;;;;6979:133;;;;7225:1;7222;7218:9;7271:1;7266:3;7262:11;7331:1;7321:7;7313:6;7309:20;7305:28;7294:39;;7388:2;7385:1;7381:10;7375:4;7371:21;7441:9;7428:23;7420:6;7413:39;;7503:2;7495:6;7485:21;7581:2;7576:3;7572:12;7567:2;7564:1;7560:10;7556:29;7548:6;7544:42;7527:59;;7639:9;7626:23;7620:4;7617:33;7607:133;;7687:1;7678:10;;7713:5;;;;;7607:133;-1:-1:-1;;;5240:1:5;5233:9;5196:2576;;8225:1138;8375:10;8526:4;8520:11;8572:4;8559:18;8609:1;8680;8665:598;8690:3;8687:1;8684:10;8665:598;;;8865:2;8858:10;;;8852:4;8848:21;8901:23;8886:39;;8954:21;;;8811:1;8750:3;8746:11;;;8789:20;;;8785:28;;9038:12;;;9033:2;9026:10;;9022:29;9014:6;9010:42;9085:23;9229:19;9213:36;;;;;8702:9;8665:598;;;-1:-1:-1;9328:19:5;;8225:1138;-1:-1:-1;;;;;;8225:1138:5:o;14:500:28:-;170:6;178;186;239:5;227:9;218:7;214:23;210:35;207:55;;;258:1;255;248:12;207:55;294:9;281:23;271:33;;338:4;327:9;323:20;362:7;358:2;355:15;352:35;;;383:1;380;373:12;352:35;421:2;410:9;406:18;396:28;;462:7;454:5;443:9;439:21;436:34;433:54;;;483:1;480;473:12;433:54;506:2;496:12;;;14:500;;;;;:::o","linkReferences":{}},"methodIdentifiers":{"verifyBranchless(uint256,bytes32[256],bytes32[2][256])":"93d3ae50","verifyFast(uint256,bytes32[256],bytes32[2][256])":"6506d2c1","verifyUnrolled(uint256,bytes32[256],bytes32[2][256])":"816cbf5d"},"rawMetadata":"{\"compiler\":{\"version\":\"0.8.31+commit.fd3a2265\"},\"language\":\"Solidity\",\"output\":{\"abi\":[{\"inputs\":[{\"internalType\":\"uint256\",\"name\":\"bits\",\"type\":\"uint256\"},{\"internalType\":\"bytes32[256]\",\"name\":\"sig\",\"type\":\"bytes32[256]\"},{\"internalType\":\"bytes32[2][256]\",\"name\":\"pub\",\"type\":\"bytes32[2][256]\"}],\"name\":\"verifyBranchless\",\"outputs\":[{\"internalType\":\"bool\",\"name\":\"valid\",\"type\":\"bool\"}],\"stateMutability\":\"pure\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"uint256\",\"name\":\"bits\",\"type\":\"uint256\"},{\"internalType\":\"bytes32[256]\",\"name\":\"sig\",\"type\":\"bytes32[256]\"},{\"internalType\":\"bytes32[2][256]\",\"name\":\"pub\",\"type\":\"bytes32[2][256]\"}],\"name\":\"verifyFast\",\"outputs\":[{\"internalType\":\"bool\",\"name\":\"valid\",\"type\":\"bool\"}],\"stateMutability\":\"pure\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"uint256\",\"name\":\"bits\",\"type\":\"uint256\"},{\"internalType\":\"bytes32[256]\",\"name\":\"sig\",\"type\":\"bytes32[256]\"},{\"internalType\":\"bytes32[2][256]\",\"name\":\"pub\",\"type\":\"bytes32[2][256]\"}],\"name\":\"verifyUnrolled\",\"outputs\":[{\"internalType\":\"bool\",\"name\":\"valid\",\"type\":\"bool\"}],\"stateMutability\":\"pure\",\"type\":\"function\"}],\"devdoc\":{\"author\":\"Lux Network Team\",\"details\":\"These functions use inline assembly for maximum gas efficiency.      They require external calls to leverage calldata optimizations. PERFORMANCE CHARACTERISTICS: - verifyFast: ~40% cheaper than standard verify, early exit on failure - verifyUnrolled: ~45% cheaper, 4x loop unrolling reduces overhead - verifyBranchless: Constant gas, side-channel resistant CALLDATA LAYOUT (for all functions):   [0x00-0x03]   function selector (4 bytes)   [0x04-0x23]   bits (32 bytes)   [0x24-0x2023] sig[256] (8192 bytes = 256 * 32)   [0x2024-0x6023] pub[256][2] (16384 bytes = 256 * 64) See: LP-4105 (Lamport OTS for Lux Safe)\",\"kind\":\"dev\",\"methods\":{\"verifyBranchless(uint256,bytes32[256],bytes32[2][256])\":{\"details\":\"No early exit - always processes all 256 elements      Useful when you need constant-time verification (side-channel resistance)\",\"params\":{\"bits\":\"The 256-bit message to verify\",\"pub\":\"256x2 array of public key hashes\",\"sig\":\"Array of 256 bytes32 preimages\"},\"returns\":{\"valid\":\"True if ALL verifications pass\"}},\"verifyFast(uint256,bytes32[256],bytes32[2][256])\":{\"details\":\"Uses bytes32[256] for signatures - MUCH cheaper than bytes[256]      Gas savings: ~40% less than standard verify due to simpler calldata layout\",\"params\":{\"bits\":\"The 256-bit message to verify\",\"pub\":\"256x2 array of public key hashes\",\"sig\":\"Array of 256 bytes32 preimages (each preimage is exactly 32 bytes)\"},\"returns\":{\"valid\":\"True if signature is valid\"}},\"verifyUnrolled(uint256,bytes32[256],bytes32[2][256])\":{\"details\":\"Processes 4 bits per iteration, reducing loop overhead by 75%      Best for when code size isn't a concern\",\"params\":{\"bits\":\"The 256-bit message to verify\",\"pub\":\"256x2 array of public key hashes\",\"sig\":\"Array of 256 bytes32 preimages\"},\"returns\":{\"valid\":\"True if signature is valid\"}}},\"title\":\"LamportOptimized\",\"version\":1},\"userdoc\":{\"kind\":\"user\",\"methods\":{\"verifyBranchless(uint256,bytes32[256],bytes32[2][256])\":{\"notice\":\"Branchless verification - constant gas regardless of result\"},\"verifyFast(uint256,bytes32[256],bytes32[2][256])\":{\"notice\":\"Ultra-optimized Lamport verification using fixed-size preimages\"},\"verifyUnrolled(uint256,bytes32[256],bytes32[2][256])\":{\"notice\":\"Hyper-optimized verification with 4x loop unrolling\"}},\"notice\":\"Gas-optimized Lamport signature verification using assembly\",\"version\":1}},\"settings\":{\"compilationTarget\":{\"LamportOptimized.sol\":\"LamportOptimized\"},\"evmVersion\":\"prague\",\"libraries\":{},\"metadata\":{\"bytecodeHash\":\"ipfs\"},\"optimizer\":{\"enabled\":true,\"runs\":200},\"remappings\":[\":forge-std/=lib/forge-std/src/\"]},\"sources\":{\"LamportOptimized.sol\":{\"keccak256\":\"0x885e788ed68d414507033053c3bc2f73825661baeba3a92e7410a82aad34daad\",\"license\":\"BSD-3-Clause\",\"urls\":[\"bzz-raw://34f73f07242d36d9d2a853d162264d3988bccec450a7dad676bf89f42801e911\",\"dweb:/ipfs/QmQBcft6EUszUNn91Gvv5pHMZmajEoobmfQyFijmDcX7HT\"]}},\"version\":1}","metadata":{"compiler":{"version":"0.8.31+commit.fd3a2265"},"language":"Solidity","output":{"abi":[{"inputs":[{"internalType":"uint256","name":"bits","type":"uint256"},{"internalType":"bytes32[256]","name":"sig","type":"bytes32[256]"},{"internalType":"bytes32[2][256]","name":"pub","type":"bytes32[2][256]"}],"stateMutability":"pure","type":"function","name":"verifyBranchless","outputs":[{"internalType":"bool","name":"valid","type":"bool"}]},{"inputs":[{"internalType":"uint256","name":"bits","type":"uint256"},{"internalType":"bytes32[256]","name":"sig","type":"bytes32[256]"},{"internalType":"bytes32[2][256]","name":"pub","type":"bytes32[2][256]"}],"stateMutability":"pure","type":"function","name":"verifyFast","outputs":[{"internalType":"bool","name":"valid","type":"bool"}]},{"inputs":[{"internalType":"uint256","name":"bits","type":"uint256"},{"internalType":"bytes32[256]","name":"sig","type":"bytes32[256]"},{"internalType":"bytes32[2][256]","name":"pub","type":"bytes32[2][256]"}],"stateMutability":"pure","type":"function","name":"verifyUnrolled","outputs":[{"internalType":"bool","name":"valid","type":"bool"}]}],"devdoc":{"kind":"dev","methods":{"verifyBranchless(uint256,bytes32[256],bytes32[2][256])":{"details":"No early exit - always processes all 256 elements      Useful when you need constant-time verification (side-channel resistance)","params":{"bits":"The 256-bit message to verify","pub":"256x2 array of public key hashes","sig":"Array of 256 bytes32 preimages"},"returns":{"valid":"True if ALL verifications pass"}},"verifyFast(uint256,bytes32[256],bytes32[2][256])":{"details":"Uses bytes32[256] for signatures - MUCH cheaper than bytes[256]      Gas savings: ~40% less than standard verify due to simpler calldata layout","params":{"bits":"The 256-bit message to verify","pub":"256x2 array of public key hashes","sig":"Array of 256 bytes32 preimages (each preimage is exactly 32 bytes)"},"returns":{"valid":"True if signature is valid"}},"verifyUnrolled(uint256,bytes32[256],bytes32[2][256])":{"details":"Processes 4 bits per iteration, reducing loop overhead by 75%      Best for when code size isn't a concern","params":{"bits":"The 256-bit message to verify","pub":"256x2 array of public key hashes","sig":"Array of 256 bytes32 preimages"},"returns":{"valid":"True if signature is valid"}}},"version":1},"userdoc":{"kind":"user","methods":{"verifyBranchless(uint256,bytes32[256],bytes32[2][256])":{"notice":"Branchless verification - constant gas regardless of result"},"verifyFast(uint256,bytes32[256],bytes32[2][256])":{"notice":"Ultra-optimized Lamport verification using fixed-size preimages"},"verifyUnrolled(uint256,bytes32[256],bytes32[2][256])":{"notice":"Hyper-optimized verification with 4x loop unrolling"}},"version":1}},"settings":{"remappings":["forge-std/=lib/forge-std/src/"],"optimizer":{"enabled":true,"runs":200},"metadata":{"bytecodeHash":"ipfs"},"compilationTarget":{"LamportOptimized.sol":"LamportOptimized"},"evmVersion":"prague","libraries":{}},"sources":{"LamportOptimized.sol":{"keccak256":"0x885e788ed68d414507033053c3bc2f73825661baeba3a92e7410a82aad34daad","urls":["bzz-raw://34f73f07242d36d9d2a853d162264d3988bccec450a7dad676bf89f42801e911","dweb:/ipfs/QmQBcft6EUszUNn91Gvv5pHMZmajEoobmfQyFijmDcX7HT"],"license":"BSD-3-Clause"}},"version":1},"id":5}